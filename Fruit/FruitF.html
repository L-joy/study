<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script>
    let LFSR = new Array(50);
    let NFSR = new Array(50);
    let key = "00000001001000110100010101100111100011000011010101111101101111011110001011010010";
    // let key = "";
    let IV = "1000000000" +
        "0000000100100011010001010110011110001001101010111100110111101111010111";
    let Qf = [
        [0.5, -0.008, -0.341, 0.174, 0.306, -0.357, 0.221, 0.007, 0.065, -0.126, -0.003, 0.115, -0.095, -0.002,
            0.03, 0.009, 0.05, 0.007, 0.025, -0.005, 0.01, -0.023, 0, 0.011, 0.013, -0.001, -0.012, 0, -0.004, -
            0.001, 0.007, 0.003, -0.003, 0.003, 0.001, -0.004, 0.002, -0.002, -0.001, -0.003, -0.009, -0.005, -
            0.009, -0.004, -0.005, 0.001, -0.002, 0, -0.001, 0, -0.001, 0, 0.004, -0.001, -0.001, 0, -0.005, 0, -
            0.001, -0.002, -0.01, -0.003, 0.001, -0.001
        ],
        [-0.002, 0.5, 0, -0.345, 0.179, 0.32, -0.353, 0.224, 0.01, 0.068, -0.142, 0.001, 0.117, -0.098, 0, 0.025,
            0.009, 0.055, 0.005, 0.016, -0.006, 0.002, -0.017, -0.011, 0.01, 0.008, 0.007, 0.002, -0.002, 0, 0, -
            0.002, 0.001, -0.004, 0.002, -0.008, 0.001, 0.001, 0.001, -0.001, -0.005, -0.003, 0.002, -0.004, 0.001,
            0, 0, -0.003, 0, -0.003, -0.003, 0.003, 0, -0.001, 0, -0.002, -0.001, 0.001, -0.002, 0.008, 0.001, -
            0.004, 0, 0
        ],
        [0.5, 0, 0.5, 0.009, -0.338, 0.176, 0.31, -0.351, 0.213, 0.01, 0.067, -0.142, 0.001, 0.112, -0.103, -0.007,
            0.039, 0.003, 0.051, 0.015, 0.023, 0.009, -0.003, -0.021, -0.003, 0.017, 0.007, 0.001, -0.001, -0.001,
            0.007, -0.002, 0.005, 0, 0.008, 0.004, -0.005, -0.001, 0, 0, 0, -0.001, 0, -0.006, -0.002, 0.004, -
            0.004, -0.005, -0.005, -0.004, -0.004, -0.002, -0.002, 0, 0.005, 0.004, -0.001, 0.003, 0, 0.002,
            0.006, 0.002, -0.001, -0.002
        ],
        [0.5, 0.5, -0.002, 0.5, -0.011, -0.348, 0.181, 0.312, -0.35, 0.216, 0.012, 0.067, -0.136, 0.008, 0.114, -
            0.103, -0.001, 0.034, 0.007, 0.055, 0.003, 0.02, -0.006, 0.009, -0.015, -0.006, 0.017, 0.013, 0.008,
            0.003, -0.009, 0.007, 0.005, -0.006, 0.006, -0.003, -0.006, -0.001, 0.002, -0.002, -0.007, 0.008, 0, -
            0.002, 0.005, -0.002, 0.002, -0.003, 0.001, 0, 0.003, 0.004, -0.001, 0.002, 0.004, 0.003, -0.004, -
            0.005, 0.004, -0.003, -0.001, 0.001, 0, 0.004
        ],
        [0.5, 0.5, 0.5, -0.006, 0.5, -0.001, -0.351, 0.189, 0.316, -0.351, 0.215, -0.004, 0.071, -0.149, -0.004,
            0.12, -0.09, 0.003, 0.024, 0.011, 0.048, 0.003, 0.015, -0.005, -0.008, -0.024, 0.012, 0.013, 0.008, 0,
            0.006, -0.005, 0.005, -0.003, -0.004, 0.004, -0.003, 0.005, 0.001, 0, -0.004, 0.004, -0.011, -0.006, -
            0, 0.001, -0.001, -0.003, 0.004, 0.007, 0.004, 0.004, 0.008, 0.004, 0.001, -0.003, 0, -0.003, 0.003, 0,
            0.002, 0.004, -0.001, -0.002
        ],
        [0.5, 0.388, 0.277, 0.464, -0.005, 0.47, 0.022, -0.256, 0.179, 0.188, -0.276, 0.205, 0.031, 0.079, -0.105,
            0.007, 0.109, -0.072, 0.005, 0.045, 0.011, 0.05, -0.004, 0.011, -0.007, -0.006, -0.013, -0.001, 0.013,
            0.005, 0.004, 0, 0.001, 0, -0.003, -0.003, -0.008, -0.004, 0.004, 0.002, -0.004, 0.003, 0, -0.001,
            0.005, -0.002, -0.001, -0.002, -0.003, 0.006, 0.001, 0.009, -0.004, 0.002, 0.004, 0.003, 0.002, 0.005, -
            0.003, 0.002, 0.002, 0, 0.003, 0.003
        ],
        [0.5, 0.5, 0.382, 0.278, 0.468, -0.001, 0.465, 0.019, -0.266, 0.177, 0.2, -0.274, 0.211, 0.023, 0.084, -
            0.097, 0.003, 0.115, -0.082, -0.004, 0.03, 0.004, 0.043, 0.01, 0.009, -0.015, -0.009, -0.013, 0, 0.02,
            0.009, 0.002, 0.005, 0.002, 0.005, -0.002, 0, 0.002, 0.003, 0.004, -0.004, 0, -0.002, -0.002, 0.004, -
            0.004, -0.007, 0, -0.007, -0.005, 0, -0.002, -0.002, 0.003, 0.003, 0.003, -0.003, -0.003, -0.001,
            0.003, 0.001, 0.004, -0.003, 0
        ],
        [0.5, 0.5, 0.5, 0.389, 0.28, 0.465, -0.007, 0.471, 0.036, -0.251, 0.178, 0.202, -0.276, 0.194, 0.034, 0.074,
            -0.101, 0.002, 0.114, -0.078, -0.002, 0.041, 0.02, 0.047, 0.004, 0.019, -0.007, 0.004, -0.008, 0.005,
            0.015, 0.006, -0.001, -0.008, -0.004, 0.006, 0.003, -0.002, -0.002, -0.001, -0.001, -0.005, 0, 0,
            0.001, 0.002, -0.002, 0.004, -0.004, 0.002, 0.003, -0.002, -0.001, 0.001, 0.004, -0.008, -0.002, 0.003,
            -0.002, -0.003, 0, -0.001, 0, -0.001
        ],
        [0.5, 0.251, 0.37, 0.256, 0.351, -0.254, 0.433, -0.008, 0.179, 0.051, -0.089, 0.124, -0.197, 0.01, 0.209,
            0.039, 0.047, -0.002, 0.005, -0.032, -0.003, -0.004, -0.007, 0.008, 0.01, 0.003, 0.003, -0.007, -0.011,
            0.003, -0.002, 0, 0.004, 0.003, -0.002, -0.002, -0.001, -0.002, 0.002, -0.003, -0.001, 0.004, 0, -0.007,
            -0.002, -0.002, 0.002, -0.001, 0.001, 0.001, -0.001, -0.002, 0.006, 0.003, -0.003, -0.003, -0.001,
            0.005, -0.004, -0.003, 0.004, 0, 0.003, 0.001
        ],
        [0.5, 0.5, 0.252, 0.371, 0.26, 0.357, -0.251, 0.44, 0.008, 0.176, 0.055, -0.077, 0.124, -0.194, 0.012,
            0.201, 0.042, 0.049, -0.004, 0.006, -0.03, -0.003, 0.003, 0, 0.002, 0.014, 0.005, 0, -0.004, -0.002, -
            0.001, 0.004, 0.001, -0.009, -0.003, 0, 0.005, 0.001, -0.001, -0.002, -0.002, 0.005, 0.004, 0, 0.003,
            0.001, -0.004, 0.004, 0.008, 0.006, 0.008, 0.006, -0.004, -0.004, -0.001, 0.004, -0.001, 0.001, 0.001,
            0.007, -0.003, 0.008, 0, 0.002
        ],
        [0.5, 0.5, 0.5, 0.246, 0.372, 0.26, 0.349, -0.251, 0.433, 0, 0.175, 0.067, -0.087, 0.131, -0.204, 0.01,
            0.206, 0.033, 0.044, -0.009, 0.009, -0.036, 0.002, 0.007, 0.001, 0.011, 0.012, 0.003, 0.001, 0.004, 0,
            0.009, 0.002, -0.004, 0.001, 0.004, -0.004, 0.005, 0.002, -0.001, -0.003, -0.001, 0.004, 0.004, -0.004,
            -0.001, -0.001, 0.001, -0.001, -0.001, -0.002, -0.003, 0.001, 0.003, -0.006, 0, -0.005, -0.002, 0.003, -
            0.004, 0.01, 0.003, 0.003, 0.001
        ],
        [0.004, 0.5, 0.5, 0.5, 0.254, 0.381, 0.271, 0.356, -0.256, 0.436, -0.007, 0.176, 0.059, -0.083, 0.129, -
            0.201, -0.002, 0.213, 0.041, 0.054, -0.006, 0.001, -0.035, 0.002, 0.007, -0.01, 0.002, 0.025, 0.009,
            0.004, -0.006, 0.003, -0.01, 0.004, 0.004, 0.007, -0.005, -0.004, -0.004, 0.006, -0.002, 0.003, -0.002,
            0.001, 0.005, -0.008, 0.003, -0.005, 0.006, -0.002, -0.003, 0.004, 0.004, -0.002, 0.004, -0.002, 0.005,
            -0.003, 0.002, 0.004, -0.003, -0.003, 0.005, -0.005
        ],
        [0.5, -0.002, 0.5, 0.5, 0.5, 0.254, 0.382, 0.274, 0.365, -0.258, 0.438, 0.001, 0.172, 0.064, -0.089, 0.115,
            -0.196, 0.003, 0.208, 0.042, 0.05, -0.005, 0.005, -0.027, 0, 0, 0.003, 0.015, 0.011, 0.008, -0.009,
            0.001, 0.003, -0.002, -0.004, -0.002, 0.001, -0.005, 0.002, -0.003, 0.006, -0.003, 0.001, 0.003, -0.003,
            -0.004, -0.002, 0.004, -0.003, -0.003, 0, -0.001, 0.002, -0.001, -0.001, -0.002, 0.007, -0.003, 0.005,
            0.001, 0.006, 0, -0.006, -0.003
        ],
        [0.5, 0.5, 0.005, 0.5, 0.5, 0.5, 0.246, 0.371, 0.271, 0.35, -0.253, 0.44, 0.009, 0.173, 0.063, -0.085,
            0.124, -0.195, 0.004, 0.213, 0.047, 0.059, -0.013, 0.005, -0.027, 0.006, 0, -0.001, 0.011, 0.012,
            0.012, -0.003, 0.001, -0.003, -0.003, 0.006, 0.004, 0.003, -0.001, 0.001, -0.004, 0, 0, 0.003, -0.003,
            0.001, 0.006, -0.002, -0.001, -0.002, 0.007, 0.002, 0, 0.002, -0.006, -0.004, -0.001, 0, -0.006, -
            0.002, 0, -0.003, -0.003, 0.002
        ],
        [0.5, 0.5, 0.5, 0.003, 0.5, 0.5, 0.5, 0.257, 0.381, 0.272, 0.353, -0.261, 0.441, -0.009, 0.178, 0.047, -
            0.09, 0.122, -0.202, 0.001, 0.205, 0.034, 0.057, -0.011, -0.001, -0.037, 0.003, 0.002, -0.004, 0.015,
            0.012, 0.003, -0.002, 0.005, -0.004, -0.002, -0.005, 0.003, 0, 0.005, -0.002, -0.002, 0.001, 0.006, -
            0.001, -0.003, -0.003, 0.001, 0.001, -0.004, -0.002, -0.004, 0.003, 0, 0.001, -0.002, -0.004, -0.002, -
            0.002, 0.001, -0.004, -0.002, 0.001, 0.002
        ],
        [0.5, 0.424, 0.349, 0.477, 0.012, 0.481, 0.455, 0.423, 0.228, 0.284, 0.223, 0.331, -0.22, 0.394, 0.005,
            0.149, 0.056, -0.076, 0.111, -0.168, -0.002, 0.185, 0.038, 0.048, -0.017, 0.005, -0.025, -0.005, -0.003,
            0.003, 0.004, 0.008, 0.003, -0.007, 0.005, 0.001, 0.001, -0.008, -0.002, 0, -0.007, 0.002, 0.007, 0, -
            0.003, 0, 0, -0.001, -0.007, 0.005, -0.005, 0.002, -0.001, 0.005, 0, 0.001, 0.001, 0.003, -0.002, -
            0.002, 0.004, 0.001, -0.003, -0.009
        ],
        [0.5, 0.251, 0.334, 0.185, 0.449, -0.004, 0.457, 0.417, 0.171, 0.143, 0.089, 0.13, -0.271, 0.008, 0.293,
            0.003, 0.068, 0.031, -0.026, -0.075, -0.003, 0, 0.001, 0.016, 0.008, -0.004, -0.005, 0, 0, 0.003, -
            0.008, -0.003, 0.005, -0.008, -0.003, 0.002, -0.001, -0.006, -0.007, 0, -0.005, 0.002, -0.004, 0.001, -
            0.002, 0, 0.003, 0.001, 0.004, -0.004, 0.001, 0.003, 0.002, -0.004, -0.001, -0.006, 0.004, -0.003,
            0.001, -0.004, -0.005, 0.001, 0.002, 0.001
        ],
        [0.5, 0.5, 0.252, 0.334, 0.19, 0.448, -0.004, 0.458, 0.414, 0.171, 0.142, 0.09, 0.131, -0.266, 0.01, 0.293,
            -0.003, 0.075, 0.029, -0.026, -0.081, 0.001, -0.001, -0.002, 0.018, 0.009, -0.008, 0.009, -0.007, -
            0.005, 0.007, 0.003, 0.006, 0.008, -0.002, -0.002, 0.003, 0.007, 0, -0.001, -0.003, 0.001, -0.002, -
            0.001, -0.001, -0.001, -0.004, -0.005, 0.001, 0.002, 0.002, 0, 0.001, 0.001, -0.002, 0.002, -0.005, 0,
            0.004, -0.001, 0, -0.001, 0.007, -0.002
        ],
        [0.5, 0.5, 0.5, 0.246, 0.335, 0.19, 0.446, -0.01, 0.457, 0.416, 0.169, 0.156, 0.093, 0.137, -0.269, 0.011,
            0.294, 0.004, 0.07, 0.035, -0.028, -0.084, 0.003, -0.003, -0.001, 0.021, 0.004, -0.008, 0.003, 0.003,
            0.004, 0.007, 0.002, 0.004, 0.007, 0.006, 0.004, -0.002, -0.008, 0.001, 0, 0.001, -0.001, 0.006, 0.002,
            0.002, 0.005, 0, -0.003, 0.001, 0.001, 0.002, -0.004, -0.004, -0.004, 0.001, 0, 0, 0, -0.004, -0.001,
            0, 0.006, -0.002
        ],
        [0.006, 0.5, 0.5, 0.5, 0.254, 0.34, 0.196, 0.448, 0.008, 0.459, 0.413, 0.174, 0.142, 0.086, 0.139, -0.268,
            0.007, 0.298, 0.009, 0.067, 0.034, -0.021, -0.087, 0, -0.003, -0.007, 0.011, 0.008, 0.004, -0.004, -
            0.008, 0.002, 0.007, 0.007, -0.009, -0.001, 0.01, 0.01, -0.004, 0.006, -0.003, -0.006, 0.001, -0.002,
            0.001, -0.002, -0.003, 0.001, -0.001, -0.001, -0.003, -0.001, -0.001, -0.003, 0.003, -0.001, 0, 0.003,
            0, 0.005, -0.002, 0.005, -0.001, 0.002
        ],
        [0.5, 0.002, 0.5, 0.5, 0.5, 0.254, 0.342, 0.201, 0.453, -0.018, 0.459, 0.42, 0.165, 0.154, 0.091, 0.131, -
            0.269, 0.001, 0.304, 0.002, 0.072, 0.03, -0.029, -0.087, -0.006, -0.002, 0.002, 0.013, 0.007, 0.001, 0,
            -0.004, -0.001, 0.01, -0.004, 0.006, 0.006, 0.002, -0.002, 0, 0.002, 0.001, 0, 0.004, 0.001, -0.006,
            0.004, 0.002, -0.004, 0.003, -0.004, 0.001, 0, -0.004, 0, -0.002, 0.003, 0.002, 0.001, -0.001, 0.001,
            0.001, 0.003, -0.002
        ],
        [0.5, 0.5, 0.008, 0.5, 0.5, 0.5, 0.246, 0.33, 0.201, 0.449, 0.002, 0.46, 0.416, 0.172, 0.144, 0.085, 0.128,
            -0.267, -0.004, 0.295, 0.008, 0.068, 0.04, -0.027, -0.075, 0.001, -0.003, 0.001, 0.012, 0.013, -0.007,
            0.008, -0.003, 0.003, 0.007, 0.008, -0.001, 0.007, 0, 0, -0.001, 0.001, 0.005, 0.001, -0.001, -0.002,
            0.002, -0.008, -0.001, -0.004, 0.001, 0.002, -0.001, -0.002, 0.002, -0.002, -0.004, 0, 0.001, -0.004,
            0.004, -0.001, 0, -0.004
        ],
        [0.5, 0.5, 0.5, -0.015, 0.5, 0.5, 0.5, 0.257, 0.34, 0.193, 0.448, -0.001, 0.46, 0.409, 0.171, 0.144, 0.092,
            0.134, -0.272, 0.005, 0.29, 0.003, 0.077, 0.039, -0.034, -0.081, -0.007, -0.003, 0.004, 0.02, 0.014, -
            0.007, 0.001, -0.003, 0.008, 0.004, 0.002, 0.006, -0.005, -0.003, 0, 0.004, -0.004, -0.005, -0.004, -
            0.004, -0.004, -0.005, -0.006, 0.001, -0.001, 0.004, -0.002, -0.001, 0.001, -0.001, 0, -0.002, 0, -
            0.002, 0.001, 0, 0, -0.001
        ],
        [0.5, 0.5, 0.5, 0.5, 0.01, 0.5, 0.5, 0.5, 0.253, 0.322, 0.187, 0.452, 0.003, 0.457, 0.412, 0.163, 0.139,
            0.098, 0.136, -0.269, -0.004, 0.293, 0.001, 0.075, 0.031, -0.031, -0.077, 0.002, -0.007, -0.001, 0.02,
            0.012, -0.002, -0.007, 0.001, 0.007, 0.007, 0.003, -0.002, 0.001, 0.003, 0.001, 0.002, -0.002, -0.006,
            0.005, -0.001, -0.001, 0.003, -0.005, -0.003, -0.001, 0, -0.002, 0.002, 0.002, -0.002, 0, 0.001, 0.001,
            0, 0, 0.005, -0.004
        ],
        [0.5, 0.251, 0.37, 0.256, 0.462, -0.003, 0.467, 0.437, 0.191, 0.152, 0.101, 0.128, -0.355, 0.003, 0.324,
            0.114, 0.084, 0.082, 0.039, -0.1, 0.005, 0.005, 0.001, -0.001, 0.01, 0.01, -0.003, 0.002, -0.004, 0.004,
            -0.004, -0.001, 0.002, -0.003, -0.004, -0.003, -0.001, 0.001, 0.003, -0.001, -0.003, 0.005, -0.009,
            0.003, 0.001, -0.001, 0.002, 0.003, -0.003, 0.004, 0.002, 0.002, 0, -0.005, -0.004, -0.004, -0.005, -
            0.002, 0.008, -0.005, -0.001, 0.002, -0.003, -0.004
        ],
        [0.5, 0.372, 0.13, 0.338, 0.228, 0.433, -0.005, 0.345, 0.356, 0.122, 0.111, 0.079, 0.102, -0.296, 0.013,
            0.254, 0.094, 0.058, 0.055, 0.021, -0.067, 0.001, 0.002, 0.005, -0.006, 0.011, 0.01, 0, -0.006, -0.005,
            -0.004, -0.012, 0.003, 0.007, -0.004, 0.004, 0.004, -0.005, 0, -0.005, -0.002, -0.003, -0.003, 0,
            0.007, 0.002, 0.003, 0.002, 0.001, 0.006, 0.003, 0.008, 0, -0.004, 0.003, -0.002, -0.003, 0.001, -
            0.001, 0.003, 0.004, 0.002, 0, -0
        ],
        [0.5, 0.5, 0.376, 0.137, 0.343, 0.229, 0.427, 0.009, 0.351, 0.362, 0.123, 0.124, 0.087, 0.109, -0.305,
            0.005, 0.255, 0.084, 0.057, 0.057, 0.033, -0.068, 0.009, -0.004, -0.004, 0.003, 0.013, 0.011, -0.003,
            0.004, -0.001, 0.003, 0.001, 0, -0.003, -0.006, -0.002, -0.006, 0.004, -0.006, -0.002, 0, -0.003,
            0.003, 0, -0.004, -0.004, 0.001, -0.004, 0.004, 0.003, -0.003, 0.002, 0.005, 0.003, 0.005, 0.004,
            0.002, -0.003, 0, 0.003, -0.005, -0.002, 0.001
        ],
        [0.5, 0.5, 0.5, 0.377, 0.139, 0.35, 0.24, 0.432, -0.001, 0.352, 0.357, 0.12, 0.114, 0.083, 0.101, -0.303,
            0.001, 0.257, 0.086, 0.066, 0.061, 0.021, -0.073, -0.001, 0.001, -0.005, -0.008, 0.01, 0.009, 0.001, -
            0.004, 0.003, 0, 0.004, 0.004, 0.004, -0.005, -0.001, -0.005, 0, -0.001, -0.002, 0.001, 0.005, -0.006,
            -0.001, -0.001, 0, 0.007, 0.002, 0.001, 0.005, 0.002, 0.001, 0.005, 0.004, -0.005, 0.002, -0.001, -
            0.003, -0.003, 0.002, -0.001, 0.004
        ],
        [-0.013, 0.5, 0.5, 0.5, 0.368, 0.133, 0.348, 0.243, 0.431, 0.004, 0.351, 0.36, 0.124, 0.123, 0.086, 0.1, -
            0.294, 0.004, 0.255, 0.099, 0.054, 0.057, 0.023, -0.07, -0.005, -0.011, -0.002, 0.002, 0.006, 0.01, -
            0.005, 0.004, 0.004, 0.001, -0.004, 0.004, 0.004, -0.001, 0.006, 0, 0.002, 0.004, 0.001, 0.005, 0.004,
            0.004, -0.005, -0.001, 0.001, -0.004, 0.002, -0.002, 0.002, -0.001, 0, -0.002, 0, -0.003, 0.002, -0.001,
            0.002, 0.005, -0.002, -0.001
        ],
        [0.5, 0.002, 0.5, 0.5, 0.5, 0.375, 0.129, 0.342, 0.239, 0.431, 0.006, 0.35, 0.358, 0.12, 0.116, 0.089,
            0.108, -0.307, -0.006, 0.256, 0.091, 0.052, 0.06, 0.027, -0.058, 0, -0.004, -0.004, -0.003, 0.009,
            0.006, -0.006, -0.005, 0.002, -0.008, 0.006, -0.006, 0, -0.001, 0.001, 0.005, 0.001, -0.003, -0.003,
            0.003, -0.003, 0.005, -0.003, -0.004, -0.001, 0, 0.001, 0.001, -0.005, 0.003, -0.004, 0, -0.003, 0.004,
            0, 0.001, 0, 0.001, -0.006
        ],
        [0.5, 0.5, -0.007, 0.5, 0.5, 0.5, 0.38, 0.141, 0.349, 0.238, 0.433, 0.003, 0.356, 0.36, 0.126, 0.124, 0.088,
            0.101, -0.302, 0.005, 0.254, 0.092, 0.066, 0.064, 0.033, -0.069, -0.002, -0.006, -0.003, 0, 0.013,
            0.008, 0.001, 0.004, 0.004, -0.003, -0.001, 0, -0.002, 0.011, -0.004, 0.009, 0.001, 0, 0.002, 0.003,
            0.003, 0, 0, -0.004, 0, 0.004, 0.004, 0.005, 0.003, 0.001, 0.003, 0.003, -0.002, 0.001, -0.001, -
            0.001, 0.001, -0.003
        ],
        [0.5, 0.5, 0.5, -0.004, 0.5, 0.5, 0.5, 0.374, 0.14, 0.337, 0.23, 0.434, -0.003, 0.349, 0.359, 0.118, 0.115,
            0.096, 0.103, -0.301, 0.004, 0.247, 0.094, 0.056, 0.067, 0.031, -0.073, 0.004, 0, -0.003, 0.001, 0.01,
            0.01, 0.006, -0.006, -0.014, -0.008, -0.001, 0.005, 0.002, 0.003, -0.001, 0.001, 0, 0.006, 0.001, 0.004,
            0.001, -0.002, -0.007, 0.006, 0, 0.002, 0.002, 0.004, 0.003, -0.002, 0.001, -0.002, 0.005, 0.006,
            0.001, -0.001, -0.003
        ],
        [0.5, 0.5, 0.5, 0.5, -0.005, 0.5, 0.5, 0.5, 0.377, 0.131, 0.343, 0.233, 0.428, -0.004, 0.354, 0.357, 0.12,
            0.116, 0.086, 0.101, -0.298, 0.004, 0.257, 0.095, 0.062, 0.06, 0.03, -0.073, -0.004, -0.007, -0.01, -
            0.004, 0.011, 0.003, 0.008, 0, -0.003, -0.012, 0.001, 0, 0.001, -0.002, -0.005, -0.002, -0.003, 0.002,
            0.002, -0.001, -0.002, 0.003, 0.002, 0, 0.001, 0.003, 0, -0.004, 0.005, 0.006, -0.006, 0.003, 0.003,
            0.002, 0.002, -0.001
        ],
        [0.5, 0.378, 0.265, 0.463, 0.455, 0.002, 0.43, 0.378, 0.41, 0.242, 0.102, 0.302, 0.191, 0.363, -0.007, 0.28,
            0.289, 0.091, 0.095, 0.07, 0.078, -0.231, 0.011, 0.204, 0.075, 0.046, 0.04, 0.019, -0.06, -0.002, 0.003,
            -0.001, 0, 0.007, 0.014, 0.002, -0.002, -0.003, -0.006, 0.002, 0.009, 0.002, 0.006, 0, 0, 0.003, 0,
            0.004, -0.003, -0.001, 0.004, 0.001, -0.003, 0.002, -0.004, -0.005, 0.001, -0.002, -0.005, -0.001, -
            0.001, -0.002, 0.004, -0
        ],
        [0.5, 0.251, 0.235, 0.002, 0.419, -0.414, 0.01, 0.361, 0.126, 0.229, 0.038, 0.058, -0.222, -0.008, 0.246,
            0.016, 0.101, 0.028, 0.015, -0.016, 0.003, -0.036, -0.003, 0.008, 0.019, 0.015, -0.006, 0.002, 0.002,
            0.01, 0, -0.001, -0.001, 0.005, 0.001, 0.002, 0.004, 0.003, 0.003, -0.002, 0.002, -0.005, -0.004,
            0.008, 0.006, 0, 0.001, -0.004, 0.001, 0, 0.002, -0.007, -0.002, -0.002, 0.001, -0.003, -0.003, 0, -
            0.009, 0.005, 0.004, -0.001, 0.007, -0.008
        ],
        [0.5, 0.5, 0.252, 0.249, 0.031, 0.422, -0.412, 0.013, 0.368, 0.128, 0.245, 0.046, 0.062, -0.231, -0.009,
            0.254, -0.005, 0.114, 0.033, 0.005, -0.004, -0.001, -0.033, 0.007, -0.004, 0.016, 0.007, -0.001, 0.007,
            -0.003, -0.005, 0.002, -0.006, 0.003, 0.01, 0.007, 0.005, -0.003, 0.003, -0.002, 0.002, -0.002, 0.005, -
            0, 0.003, 0, 0.001, -0.004, -0.002, -0.001, 0.002, -0.003, 0.002, -0.004, -0.002, -0.002, 0.005, 0.004,
            -0.002, -0.002, 0, 0.002, 0.005, -0.001
        ],
        [0.5, 0.5, 0.5, 0.246, 0.252, 0.036, 0.421, -0.411, -0.002, 0.366, 0.122, 0.247, 0.057, 0.061, -0.225, -
            0.007, 0.25, -0.005, 0.115, 0.031, 0.008, -0.014, 0, -0.031, 0, 0.005, 0.013, 0.007, 0.006, -0.007, -
            0.002, 0.001, -0.01, 0.001, -0.002, -0.001, 0.005, -0.003, 0, -0.003, 0, 0.002, 0.004, -0.004, 0.001,
            0.001, 0.001, -0.004, -0.003, 0.001, -0.001, 0, -0.002, 0.002, -0.001, 0, 0.009, -0.001, -0.001,
            0.001, 0.001, 0.003, 0.001, -0.001
        ],
        [-0.006, 0.5, 0.5, 0.5, 0.254, 0.257, 0.032, 0.424, -0.413, -0.001, 0.367, 0.124, 0.239, 0.053, 0.06, -
            0.228, -0.009, 0.257, -0.012, 0.103, 0.034, 0.007, -0.008, 0.003, -0.034, 0.004, -0.004, 0.018, 0.011, -
            0.001, 0.008, 0.005, 0.004, -0.004, -0.008, -0.008, -0.002, 0.006, -0.005, 0.006, -0.005, -0.004, 0.001,
            0, -0.003, 0.004, 0, -0.002, -0.002, 0.001, -0.001, -0.001, -0.001, 0.002, -0.002, -0.001, 0, -0.003, -
            0.007, -0.005, 0.001, -0.002, -0.002, -0.001
        ],
        [0.5, -0.004, 0.5, 0.5, 0.5, 0.254, 0.258, 0.034, 0.425, -0.41, -0.002, 0.371, 0.126, 0.244, 0.052, 0.052, -
            0.23, -0.007, 0.258, -0.012, 0.111, 0.047, 0.01, -0.009, 0.005, -0.034, 0.008, 0.005, 0.016, 0.013,
            0.002, 0.007, 0.002, -0.005, -0.002, -0.003, 0.003, 0.002, 0.002, 0.001, -0.001, 0.003, -0.003, 0.003, -
            0.001, -0.01, -0.009, 0.003, 0.001, 0.002, 0, -0.002, 0.002, -0.003, 0.001, 0, -0.006, 0, -0.001, -
            0.005, -0.002, 0.004, -0.003, 0
        ],
        [0.5, 0.5, 0.005, 0.5, 0.5, 0.5, 0.246, 0.246, 0.038, 0.42, -0.413, 0.008, 0.362, 0.12, 0.239, 0.051, 0.06,
            -0.23, -0.001, 0.261, -0.011, 0.118, 0.034, 0.019, -0.012, -0.001, -0.033, 0, -0.001, 0.019, 0.007,
            0.003, -0.001, -0.004, 0.001, -0.003, 0.001, 0.003, 0.006, -0.002, 0.001, 0.003, -0.011, 0.009, 0.004,
            0.002, 0.001, -0.001, -0.001, 0.003, -0.001, 0.001, 0.001, 0, 0, -0.002, -0.003, 0.001, 0.001, -0.007,
            0.002, -0.002, 0.007, 0.002
        ],
        [0.5, 0.5, 0.5, 0.007, 0.5, 0.5, 0.5, 0.257, 0.257, 0.032, 0.42, -0.408, -0.002, 0.357, 0.126, 0.242, 0.05,
            0.052, -0.23, -0.007, 0.249, 0.006, 0.115, 0.032, 0.012, -0.005, -0.002, -0.031, 0.002, 0.002, 0.022,
            0.006, -0.001, -0.005, 0.006, -0.008, -0.001, 0.011, 0, 0.004, 0, -0.003, 0.006, 0.005, 0.002, -0.001,
            -0.003, 0.004, 0.004, 0.005, -0.007, 0.001, 0.001, 0.001, 0.003, -0.009, -0.002, 0.002, -0.005, 0.003,
            0.006, 0.005, -0.005, 0
        ],
        [0.5, 0.42, 0.354, 0.473, 0.004, 0.48, 0.456, 0.424, 0.228, 0.185, 0.031, 0.387, -0.367, -0.007, 0.316,
            0.111, 0.223, 0.052, 0.056, -0.199, 0, 0.225, 0.005, 0.096, 0.04, 0.012, -0.009, -0.002, -0.026, -0.003,
            0.007, 0.017, 0.009, 0, -0.006, 0.006, -0.001, 0.003, 0.01, 0.002, 0.005, 0.001, -0.001, 0, 0.007, 0,
            -0.002, 0.005, -0.005, 0.001, 0.001, 0.001, -0.006, -0.006, 0.003, 0.001, -0.003, 0, -0.001, 0.001, 0,
            0.005, -0.002, -0.002
        ],
        [0.5, 0.5, 0.419, 0.348, 0.477, -0.002, 0.479, 0.458, 0.419, 0.231, 0.183, 0.034, 0.383, -0.364, -0.001,
            0.311, 0.123, 0.225, 0.044, 0.051, -0.199, -0.004, 0.22, 0.003, 0.097, 0.034, 0.009, -0.012, -0.005, -
            0.025, 0.001, 0.005, 0.019, 0.006, -0.002, 0.005, 0.004, 0.008, 0.003, 0.006, -0.002, 0.001, 0, 0.001,
            0.005, 0.005, -0.006, -0.007, -0.004, 0.009, -0.005, -0.003, -0.005, -0.003, -0.001, -0.007, -0.004, -
            0.002, 0.005, -0.003, -0.002, 0.002, 0.001, -0.002
        ],
        [0.5, 0.251, 0.37, 0.203, 0.336, -0.442, -0.011, 0.416, 0.175, 0.255, 0.06, 0.092, -0.046, -0.011, -0.271,
            0.005, 0.137, 0.05, 0.074, -0.022, 0.001, 0.117, -0.004, 0.065, 0.004, 0.025, -0.007, 0.001, -0.003, -
            0.002, -0.009, -0.009, 0, -0.005, 0.002, 0.005, -0.003, -0.011, 0.005, 0.002, 0.004, 0.008, 0.001,
            0.003, 0.004, 0.002, -0.007, -0.004, -0.001, -0.001, 0, 0.002, 0.001, 0.001, -0.004, -0.004, 0, 0.001,
            -0.001, -0.004, 0.007, 0.003, 0.001, 0.002
        ],
        [0.5, 0.5, 0.252, 0.371, 0.208, 0.338, -0.435, -0.007, 0.415, 0.174, 0.264, 0.058, 0.086, -0.03, -0.006, -
            0.267, 0.004, 0.142, 0.047, 0.069, -0.018, 0.004, 0.11, 0.003, 0.061, -0.007, 0.009, -0.003, 0.001, -
            0.005, 0.001, -0.001, -0.001, -0.001, -0.006, -0.003, 0.008, -0.003, -0.009, 0, 0.002, -0.007, 0.003,
            0.004, 0.007, 0.015, -0.004, -0.003, -0.004, -0.002, -0.002, -0.001, 0.001, -0.003, 0.003, -0.001,
            0.002, -0.003, 0, 0.003, 0.001, 0.002, 0.007, -0.004
        ],
        [-0.5, 0.5, 0.5, 0.246, 0.372, 0.202, 0.335, -0.433, -0.008, 0.415, 0.166, 0.26, 0.066, 0.091, -0.043, -
            0.011, -0.266, -0.003, 0.143, 0.043, 0.077, -0.012, 0.002, 0.11, -0.003, 0.07, -0.001, 0.016, -0.004,
            0.002, -0.008, 0.001, -0.01, 0, -0.003, 0.005, -0.005, 0.012, 0.004, -0.013, 0, -0.001, -0.003, -0.004,
            0, -0.005, -0.005, 0.007, 0.002, -0.006, -0.001, 0.003, 0.004, 0, -0.006, 0.002, -0.003, 0.001, -0.004,
            -0.001, 0.005, -0.006, 0.005, -0.002
        ],
        [0.5, -0.5, 0.5, 0.5, 0.254, 0.381, 0.222, 0.338, -0.438, -0.007, 0.414, 0.173, 0.259, 0.06, 0.085, -0.026,
            0, -0.264, 0, 0.138, 0.047, 0.071, -0.017, 0.005, 0.11, -0.002, 0.072, 0.002, 0.014, -0.008, -0.006, -
            0.004, -0.005, -0.009, 0.002, -0.003, -0.002, 0.005, 0.002, 0.005, -0.002, -0.002, -0.002, -0.001,
            0.001, 0, -0.007, 0, -0.002, 0, 0, 0.008, 0.003, -0.006, 0.008, 0.004, 0.001, 0, 0.002, 0.001, -0.004,
            0.002, -0.001, 0.003
        ],
        [0.5, 0.5, -0.5, 0.5, 0.5, 0.254, 0.382, 0.223, 0.35, -0.437, -0.009, 0.42, 0.168, 0.27, 0.067, 0.095, -
            0.039, 0, -0.272, -0.005, 0.141, 0.051, 0.073, -0.024, -0.001, 0.116, 0.001, 0.07, 0.002, 0.011, -0.016,
            0.003, -0.008, 0.004, -0.007, -0.002, -0.005, -0.001, -0.008, 0.001, 0.004, -0.001, 0, 0.001, 0.001,
            0.004, 0.006, 0, -0.003, 0.003, -0.003, -0.003, -0.005, -0.003, -0.003, -0.003, 0.002, -0.001, 0.004,
            0.001, 0.001, 0.003, -0.001, 0.002
        ],
        [0.5, 0.5, 0.5, -0.5, 0.5, 0.5, 0.246, 0.371, 0.216, 0.334, -0.438, -0.017, 0.417, 0.169, 0.253, 0.063,
            0.101, -0.035, -0.001, -0.265, -0.001, 0.139, 0.044, 0.072, -0.022, 0.001, 0.11, -0.005, 0.068, -0.004,
            0.007, -0.008, -0.002, -0.012, -0.001, -0.007, 0.004, -0.002, -0.002, 0.006, 0, -0.001, 0.002, -0.002, -
            0.007, 0.001, 0.003, 0.002, -0.005, -0.003, -0.004, -0.002, 0.005, 0.001, -0.007, 0, -0.003, -0.006, -
            0.006, -0.001, -0.003, 0, -0.005, -0.002
        ],
        [0.238, 0.379, 0.259, 0.457, -0.453, 0.466, 0.435, 0.19, 0.31, 0.141, 0.254, -0.373, -0.005, 0.342, 0.133,
            0.197, 0.054, 0.068, -0.022, 0.009, -0.191, 0.01, 0.109, 0.04, 0.055, -0.019, -0.002, 0.081, 0, 0.057, -
            0.006, 0.011, 0.004, 0.007, -0.009, -0.003, 0, -0.006, -0.002, 0.001, 0.001, 0.004, -0.004, 0.003, -
            0.004, -0.001, -0.003, 0.002, 0.002, 0.004, -0.003, 0.003, 0.005, -0.005, -0.001, -0.004, 0.004, -0.004,
            -0.001, 0.003, -0.003, -0.001, -0.005, 0.003
        ]
    ];
    // 密钥装载阶段
    function frvitF() {

        if (key.length !== 80) {
            console.log("error");
        }
        for (let i = 0; i < NFSR.length; i++) {
            NFSR[i] = IV.charAt(i) === '1' ? 1 : 0;
        }
        let j = 0;
        for (let i = NFSR.length; i < NFSR.length + 30; i++) {
            LFSR[j] = IV.charAt(i) === '1' ? 1 : 0;
            j++;
        }
        for (let i = 30; i < LFSR.length - 1; i++) {
            LFSR[i] = 1
        }
        LFSR[49] = 0;
    }
    // 初始化阶段
    function init() {
        frvitF();
        // 第一轮初始化
        let fb = 0;
        for (let i = 0; i < 128; i++) {
            clockOneTime(fb);
            let z = output();
            fb = z;
        }
    }
    // 轮密钥函数
    function keyRound() {
        let r = (NFSR[44]) * Math.pow(2, 0) +
            (NFSR[0]) * Math.pow(2, 1) +
            (LFSR[33]) * Math.pow(2, 2) +
            (LFSR[49]) * Math.pow(2, 3);
        let p = (NFSR[20]) * Math.pow(2, 0) +
            (NFSR[5]) * Math.pow(2, 1) +
            (NFSR[49]) * Math.pow(2, 2) +
            (LFSR[15]) * Math.pow(2, 3) +
            (LFSR[41]) * Math.pow(2, 4) + 16;
        let q = (NFSR[26]) * Math.pow(2, 0) +
            (NFSR[13]) * Math.pow(2, 1) +
            (NFSR[37]) * Math.pow(2, 2) +
            (LFSR[5]) * Math.pow(2, 3) +
            (LFSR[25]) * Math.pow(2, 4) + 48;

        let k = (parseInt(key.charAt(p)) & parseInt(key.charAt(q))) ^
            parseInt(key.charAt(r)) ^ parseInt(key.charAt(p)) ^ parseInt(key.charAt(q));
        return k;
    }
    // NFSR反馈函数
    function feedbackNFSR() {
        let g;
        g = keyRound() ^ LFSR[0] ^ NFSR[0] ^ NFSR[11] ^ NFSR[30] ^ (NFSR[16] & NFSR[32]) ^
            (NFSR[25] & NFSR[42]) ^ (NFSR[7] & NFSR[20] & NFSR[35]) ^ (NFSR[4] & NFSR[45]) ^
            (NFSR[40] & NFSR[44] & NFSR[47] & NFSR[48]);
        return g;
    }

    // LFSR反馈函数
    function feedbackLFSR() {
        return LFSR[43] ^ LFSR[34] ^ LFSR[24] ^ LFSR[16] ^ LFSR[8] ^ LFSR[0];
    }

    function output() {
        let z;
        let h;
        h = (LFSR[11] & LFSR[37]) ^ (LFSR[1] & LFSR[19]) ^ (NFSR[24] & LFSR[28]) ^ (NFSR[9] & NFSR[49]) ^
            (NFSR[1] & NFSR[33] & LFSR[49]);

        z = h ^ NFSR[0] ^ NFSR[17] ^ NFSR[28] ^ NFSR[41] ^ NFSR[48] ^ LFSR[45];
        return z;
    }

    function clockOneTime(fb) {
        let fbLFSR = feedbackLFSR();
        let fbNFSR = feedbackNFSR();

        for (let i = 0; i < LFSR.length - 1; i++) {
            LFSR[i] = LFSR[i + 1];
        }
        for (let i = 0; i < NFSR.length - 1; i++) {
            NFSR[i] = NFSR[i + 1];
        }

        NFSR[49] = fbNFSR ^ fb;
        LFSR[49] = fbLFSR ^ fb;
    }

    function stream() {
        init();
        let Stream = [];
        for (let i = 0; i < 64; i++) {
            Stream.push(output());
            clockOneTime(0);
        }
        // console.log('无错误密钥流', Stream.join(""));
        return Stream;
    }

    function faultStream(n) {
        init();
        if (LFSR[n] === 1) {
            LFSR[n] = 0;
        } else {
            LFSR[n] = 1;
        }
        let Stream = [];
        for (let i = 0; i < 64; i++) {
            Stream.push(output());
            clockOneTime(0);
        }
        // console.log('有错误密钥流', Stream.join(""));
        return Stream;
    }
    // stream();
    // faultStream(0);

    //需要数据：1.签名向量Qf；2.错误路径Lg；3.相关系数u(Q,L)
    function QFData(x) {

        for (let k = 0; k < 50; k++) {
            let result = [];
            for (let index = 0; index < x; index++) {
                result[index] = 0;
            }
            for (let i = 0; i < Math.pow(2, 15); i++) {
                key = "0000000100" +
                    "1000110100" +
                    "0101011001" +
                    "1110001100" +
                    "0011010101" +
                    "1111011011" +
                    "11110";
                let temp = i.toString(2);
                let res = temp;
                if (temp.length < 15) {
                    for (let i = 0; i < 15 - temp.length; i++) {
                        res = '0' + res
                    }
                }
                key = key + res;
                let output = stream().splice('');
                let faultOutput = faultStream(k).splice('');
                for (let j = 0; j < output.length; j++) {
                    if (output[j] !== faultOutput[j]) {
                        result[j] += 1;
                    }
                }

            }
            for (let i = 0; i < result.length; i++) {
                result[i] = parseFloat((0.5 - result[i] / Math.pow(2, 15)).toFixed(3));
            }
            console.log(k, result);

        }

    }

    function LGData(f) {
        let res = [];
        let output = stream().splice('');
        let faultOutput = faultStream(f).splice('');
        for (let j = 0; j < output.length; j++) {
            if (output[j] !== faultOutput[j]) {
                res[j] = 1;
            } else {
                res[j] = 0;
            }
        }
        for (let i = 0; i < res.length; i++) {
            res[i] = (0.5 - res[i]);
        }
        return res;
    }

    // QFData(64);

    // console.log(uData(a, b));
    // 计算两个向量的相关系数
    function uData(a, b) {
        let avgQf = avg(a);
        let avgLg = avg(b);
        let top = 0;
        let left = 0;
        let right = 0;
        for (let i = 0; i < a.length; i++) {
            top += (a[i] - avgQf) * (b[i] - avgLg);
            left += Math.pow((a[i] - avgQf), 2);
            right += Math.pow((b[i] - avgLg), 2);
        }
        left = Math.sqrt(left);
        right = Math.sqrt(right);
        return (top / (left * right));
    }

    function avg(arr) {
        let sum = 0;
        for (let i = 0; i < arr.length; i++) {
            sum += arr[i];
        }
        return (sum / arr.length);
    }

    function maxUData() {
        for (let f = 0; f < 50; f++) {
            let uRes = [];
            for (let i = 0; i < Qf.length; i++) {
                uRes[i] = uData(Qf[i], LGData(f));
            }
            // console.log(uRes);
            console.log(f);
            // console.log(uRes.max().toFixed(3));
            // console.log(uData(Qf[f], LGData(f)).toFixed(3));
            let r = uData(Qf[f], LGData(f)).toFixed(3);
            let Tg = [];
            while(uRes.max()[0] !== uData(Qf[f], LGData(f))){
                Tg.push(uRes.max()[1]);
                uRes[uRes.max()[1]] = Number.MIN_VALUE;
            }
            if(uRes.max()[0] === uData(Qf[f], LGData(f))){
                Tg.push(uRes.max()[1]);
            }
            console.log(Tg);
            
      
        }


    }
    Array.prototype.max = function () {
        var max = this[0];
        let index = 0;
        var len = this.length;
        for (var i = 1; i < len; i++) {
            if (this[i] > max) {
                max = this[i];
                index = i;
            }
        }
        return [max,index];
    }
    maxUData();
</script>

</html>