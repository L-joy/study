<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script>
    let LFSR = new Array(43);
    let NFSR = new Array(37);
    let Cr = new Array(7);
    let Cc = new Array(8);
    // 0000000100100011010001010110011110001001101010111100110111101111010111
    // 00000001001000110100010101100111100011000011010101111101101111011110000110100000
    let key = '00000001001000110100010101100111100011000011010101111101101111011110000110100000';
    let IV = "1000000000" +
        "0000000100100011010001010110011110001001101010111100110111101111010111" +
        "0000000000" +
        "0000000000" +
        "0000000000" +
        "0000000000" +
        "0000000000";
    let Qf = [
        [0.5, -0.25, 0.003, 0.5, 0.189, -0.436, 0.377, 0.104, -0.276, 0.409, 0, -0.337, 0.429, 0.003, 0.125, 0.193,
            0, -0.328, 0.269, 0.013, 0.002, 0.001, 0, -0.179, -0.007, -0.003, 0.001, 0.004, -0.001, -0.007, 0, -
            0.002, -0.001, -0.002, -0.002, 0.001, 0.005, 0.003, 0.003, -0.001, 0.003, 0.002, 0.001, -0, 0.003,
            0.001, -0.007, -0.001, 0.001, 0.003, 0.002, 0.003, -0.007, 0.003, 0.007, -0.003, 0.002, -0.003, 0.002,
            0.002, -0.005, -0.001, 0.003, 0.006
        ],
        [0.005, 0.5, -0.253, -0.003, 0.5, 0.185, -0.44, 0.376, 0.103, -0.281, 0.413, 0.005, -0.335, 0.43, 0.003,
            0.125, 0.191, 0.001, -0.325, 0.273, 0.013, -0, -0.001, -0.004, -0.177, -0.007, -0.001, -0.003, -0.002,
            0.001, -0.001, 0.003, 0.002, -0.001, 0.003, -0.003, 0.001, 0.001, -0.004, 0.002, -0.002, -0.003, 0.001,
            -0.001, -0.003, -0.004, -0.001, -0.002, -0.003, 0.002, 0, -0.005, 0.002, 0.002, -0.001, 0.002, -0.001,
            0, -0.005, -0.001, 0.006, 0.001, -0.001, 0.001
        ],
        [0.5, -0.005, 0.5, -0.251, -0.002, 0.5, 0.188, -0.435, 0.375, 0.108, -0.281, 0.41, -0.002, -0.336, 0.431, -
            0.004, 0.126, 0.193, 0, -0.327, 0.268, 0.01, 0.005, -0.005, -0.003, -0.18, -0.004, -0.001, 0.001, -
            0.003, -0, -0.006, -0.004, -0.005, -0, -0.002, 0.002, 0.002, 0.002, 0.002, 0, 0.005, 0, 0.003, -0.003,
            0.002, -0.002, -0.001, 0.001, 0, 0.001, -0.002, 0.002, -0.001, -0.005, -0.001, -0.003, -0.001, 0.001, -
            0.002, 0.003, 0.003, 0.004, -0
        ],
        [0.5, 0.5, -0.002, 0.5, -0.248, -0.002, 0.5, 0.184, -0.437, 0.377, 0.107, -0.279, 0.409, 0, -0.336, 0.429, -
            0.002, 0.122, 0.192, 0.003, -0.326, 0.272, 0.016, -0.001, 0.001, -0.008, -0.179, -0.014, -0, 0.005, -
            0.002, 0, -0.006, 0, 0.001, -0.002, 0.004, 0.007, 0.002, -0.002, -0.001, 0, -0, 0.004, -0.001, -0.002, -
            0.003, 0.003, 0.001, -0.003, 0.002, -0.001, -0.003, -0.002, -0, -0.004, -0.001, 0.001, -0, 0.003, -
            0.004, -0.002, 0.001, -0.003
        ],
        [0.5, 0.5, 0.5, -0.001, 0.5, -0.248, 0.004, 0.5, 0.184, -0.436, 0.373, 0.109, -0.28, 0.411, -0.002, -0.333,
            0.428, 0.004, 0.127, 0.196, -0.002, -0.328, 0.272, 0.012, -0.004, -0, 0, -0.181, -0.008, -0.004, 0.004,
            0.004, -0.001, -0.001, -0.005, -0, 0.005, 0.005, 0.004, 0, 0.002, -0.004, -0.001, -0.001, 0.003, -0, -
            0.001, 0.001, 0.001, 0.001, -0.001, 0, 0.005, -0.005, 0.001, 0, 0, 0.003, 0, -0.003, -0.001, -0, -0.005,
            0.001
        ],
        [0.5, 0.5, 0.5, 0.5, 0.003, 0.5, -0.249, 0.001, 0.5, 0.186, -0.439, 0.375, 0.11, -0.278, 0.411, -0.002, -
            0.336, 0.43, -0.001, 0.128, 0.186, -0.005, -0.326, 0.269, 0.015, -0.002, 0.006, 0.001, -0.176, -0.011,
            0.003, -0.003, 0, 0.005, -0.007, -0.003, 0.001, -0.003, 0.001, -0, 0.006, -0.001, 0.003, -0.001, -0.002,
            0.002, -0.002, 0.004, -0.002, 0.004, 0.001, 0.001, -0.003, 0.004, -0.001, 0.001, -0.003, 0.001, -0.001,
            0.002, 0.001, -0.002, 0.002, -0.001
        ],
        [-0, 0.5, 0.5, 0.5, 0.5, 0, 0.5, -0.253, 0.004, 0.5, 0.188, -0.437, 0.375, 0.108, -0.276, 0.409, 0.002, -
            0.336, 0.429, 0.004, 0.122, 0.192, 0.003, -0.323, 0.267, 0.018, -0.003, 0.005, 0.006, -0.181, -0.009, -
            0.002, 0.003, -0.004, -0.002, -0.006, -0.005, 0.003, -0.004, -0.001, 0, 0.005, -0.003, -0.002, -0.002, -
            0.003, 0, -0.005, -0.002, 0.002, -0, 0, -0.003, 0, -0.004, -0.006, -0.001, -0, 0.004, -0.001, 0, -0.004,
            -0.001, 0.005
        ],
        [0.5, 0.005, 0.5, 0.5, 0.5, 0.5, -0.001, 0.5, -0.25, -0.002, 0.5, 0.192, -0.437, 0.376, 0.11, -0.278, 0.41,
            -0.002, -0.337, 0.426, 0.001, 0.128, 0.194, 0.005, -0.326, 0.272, 0.015, 0.006, 0, 0, -0.183, -0.005, 0,
            -0.003, 0.003, 0.001, -0.005, 0, 0.001, 0.002, -0.003, -0.001, -0.003, -0.004, -0.002, -0.003, 0.001, -
            0.002, -0.009, -0.001, 0, 0, -0.001, -0.002, 0.002, -0.005, 0.003, 0.005, -0, -0.001, 0.001, -0.002, -
            0.003, -0.002
        ],
        [0.5, 0.25, 0, 0.5, 0.5, -0.5, 0.5, 0.002, 0.5, -0.251, -0.005, -0.5, 0.188, -0.219, 0.376, 0.11, 0.001, -
            0.412, 0.003, -0.172, -0.427, -0.001, -0.002, -0.19, -0.003, -0.002, 0.172, -0.003, -0, 0.002, 0.003, -
            0.001, -0.004, 0.004, -0.001, 0.004, -0.001, -0.003, 0.004, -0.001, 0.001, -0.002, -0.001, 0.002, -
            0.003, 0.005, -0.001, -0, -0.002, -0.003, 0.002, 0.002, -0.001, 0.002, 0.003, -0, -0.001, 0.001, 0.004,
            -0.002, -0.002, -0, 0.003, 0.002
        ],
        [0.5, 0.5, 0.253, -0.006, 0.5, 0.5, -0.5, 0.5, 0.004, 0.5, -0.253, 0.003, -0.5, 0.189, -0.218, 0.374, 0.107,
            -0.003, -0.407, 0.002, -0.167, -0.428, 0.001, 0.001, -0.191, -0.001, -0.002, 0.171, -0.002, 0.003,
            0.005, 0.002, -0.005, -0.001, -0.003, 0.003, -0.004, 0.006, -0.001, -0.003, 0.003, -0.004, 0.001, -
            0.004, 0.001, -0.002, -0.009, -0.003, 0.004, -0.001, -0.002, 0.001, -0.001, -0.006, -0.001, -0.001, -
            0.002, -0, -0.006, -0.001, -0.002, 0.001, -0.004, 0.001
        ],
        [0.5, 0.5, 0.5, 0.251, 0.002, 0.5, 0.5, -0.5, 0.5, -0, 0.5, -0.252, -0.002, -0.5, 0.192, -0.218, 0.375,
            0.103, -0, -0.41, 0.002, -0.176, -0.429, -0.004, -0.002, -0.189, 0.001, 0.008, 0.165, -0.007, -0.004,
            0.003, 0.001, -0.001, -0.005, 0.001, -0.002, 0.002, 0.003, -0.002, 0, 0.003, -0, -0.002, 0.003, 0.005, -
            0.003, 0.002, 0.004, 0.001, -0.004, -0, 0.005, 0.002, -0, 0.004, 0.002, -0.004, 0.001, -0.005, -0.003, -
            0.002, -0.004, -0
        ],
        [0.004, 0.5, 0.5, 0.5, 0.248, 0.004, 0.5, 0.5, -0.5, 0.5, 0, 0.5, -0.249, -0, -0.5, 0.189, -0.214, 0.375,
            0.107, 0.001, -0.41, -0.002, -0.167, -0.43, 0.005, -0.001, -0.193, 0, 0.001, 0.175, -0, -0, -0, -0.005,
            -0, 0.002, 0.002, 0.003, -0.004, 0.003, 0.001, 0.002, -0.001, 0.002, -0.001, 0, -0.004, -0, -0.002, -
            0.002, -0.005, 0.009, -0.002, 0.003, -0.001, -0.002, -0.001, 0.001, 0.003, -0.001, -0, -0.001, 0, 0
        ],
        [0.5, 0.001, 0.5, 0.5, 0.5, 0.248, -0, 0.5, 0.5, -0.5, 0.5, 0.003, 0.5, -0.249, 0.002, -0.5, 0.186, -0.218,
            0.376, 0.111, -0.002, -0.411, 0.003, -0.167, -0.429, 0.004, -0.002, -0.193, 0.004, -0.001, 0.17, 0, -
            0.001, 0.005, 0.002, 0.005, 0.001, 0.002, 0.004, -0.003, -0.001, -0, -0.004, -0.002, -0, -0.004, 0.003,
            -0.002, -0.001, -0.001, 0.004, 0.003, 0.003, 0.001, 0, 0.007, 0.003, 0.001, -0, -0.001, 0.003, 0.001, -
            0.003, -0.002
        ],
        [0.5, 0.5, 0.004, 0.5, 0.5, 0.5, 0.249, 0.005, 0.5, 0.5, -0.5, 0.5, 0.001, 0.5, -0.25, -0.001, -0.5, 0.186,
            -0.221, 0.372, 0.105, 0.003, -0.407, 0.005, -0.171, -0.427, 0.003, 0.001, -0.19, 0.006, 0.002, 0.171,
            0.004, -0.001, -0.001, 0.002, -0.002, 0, -0, 0.005, 0.004, -0.001, -0.002, 0, -0.001, -0.004, -0.005, -
            0.001, 0, -0, 0.001, 0, -0.001, 0.002, -0.001, 0.003, 0.002, -0.006, 0.003, 0.001, 0.005, -0.002, -
            0.007, -0.002
        ],
        [0.5, 0.5, 0.5, -0.002, 0.5, 0.5, 0.5, 0.253, -0.005, 0.5, 0.5, -0.5, 0.5, 0.001, 0.5, -0.25, -0.006, -0.5,
            0.185, -0.217, 0.374, 0.113, 0.003, -0.408, 0.004, -0.165, -0.427, 0.002, 0.004, -0.191, -0.001, -0.001,
            0.172, -0.006, -0.002, -0.006, -0.007, -0.001, 0.003, 0, -0.001, -0, 0.001, -0.001, -0, -0.001, 0.004, -
            0.003, -0.004, 0.001, -0.001, 0.001, 0.002, 0.003, 0.001, 0.003, 0.004, 0.005, -0.004, -0.001, -0.002,
            0.001, -0.001, 0.001
        ],
        [-0.002, 0.5, 0.5, 0.5, 0.001, 0.5, 0.5, 0.5, 0.25, -0.002, 0.5, 0.5, -0.5, 0.5, 0.002, 0.5, -0.246, -0, -
            0.5, 0.187, -0.219, 0.372, 0.108, -0.002, -0.412, -0.004, -0.167, -0.427, 0.003, -0.004, -0.188, 0.001,
            0, 0.166, 0.003, -0.005, 0, -0.005, -0.001, -0.003, 0, -0, -0.001, 0.004, -0.002, 0, 0.001, 0.001, -
            0.003, 0.005, -0.003, 0.002, -0.003, -0.004, 0.004, -0.001, 0.002, -0, -0.003, 0.005, -0.001, 0.004, -
            0.006, -0.005
        ],
        [0.5, 0.006, 0.5, 0.5, 0.5, 0.003, 0.5, 0.5, 0.5, 0.251, -0.001, 0.5, 0.5, -0.5, 0.5, 0.001, 0.5, -0.248, -
            0.007, -0.5, 0.186, -0.221, 0.376, 0.109, 0.002, -0.411, -0.002, -0.167, -0.429, -0.001, -0.001, -0.19,
            0.004, -0.001, 0.173, 0.005, 0, 0.003, -0.001, 0, 0.001, 0.002, -0.001, -0.001, -0.002, 0.006, 0.001,
            0.003, -0.003, 0.002, -0.002, 0.002, 0.003, -0.002, 0.003, -0, 0, -0.001, 0.001, 0, -0.001, -0.003, -
            0.005, 0.001
        ],
        [0.5, 0.5, -0.001, 0.5, 0.5, 0.5, 0.001, 0.5, 0.5, 0.5, 0.253, 0.003, 0.5, 0.5, -0.5, 0.5, 0, 0.5, -0.253, -
            0.003, -0.5, 0.184, -0.217, 0.376, 0.109, 0, -0.41, 0.005, -0.159, -0.43, -0.005, -0.002, -0.191, -
            0.004, -0.002, 0.17, -0.001, 0, 0, 0.005, 0.003, -0.007, 0.003, -0.001, -0.004, 0.001, 0.002, -0.001, -
            0.004, -0.003, 0.001, -0.001, -0.004, -0.001, 0, 0.002, -0.003, 0.002, -0.001, -0.001, 0.001, -0.001, -
            0.001, 0.001
        ],
        [0.5, 0.25, 0.5, 0.002, 0.5, -0.5, 0.5, -0.003, 0.5, 0.5, -0, -0.252, 0, 0.249, 0.5, -0.5, -0.002, 0, 0.5, -
            0.5, 0.002, -0.001, -0.002, 0.217, 0.375, -0.002, -0.002, 0.001, 0.002, 0.166, 0.001, 0.004, 0.003,
            0.007, -0.001, 0.167, 0.003, 0.001, -0.001, -0.071, 0.002, 0.003, 0.004, 0.002, 0.002, 0.008, -0.001, -
            0.002, 0.007, 0.003, 0.002, -0.001, -0.006, -0.001, -0.003, 0.004, -0, 0.001, -0.001, 0.001, 0.001,
            0.005, -0.005, -0.004
        ],
        [0.5, 0.5, 0.253, 0.5, 0.002, 0.5, -0.5, 0.5, 0.003, 0.5, 0.5, 0.005, -0.249, -0.001, 0.25, 0.5, -0.5,
            0.006, 0.002, 0.5, -0.5, -0.003, 0.007, -0.001, 0.222, 0.374, 0.007, -0, -0.003, 0.002, 0.166, -0,
            0.001, 0.003, 0.001, 0.005, 0.159, 0.001, -0.003, -0.002, -0.066, 0.002, 0.006, -0.001, -0, -0.005,
            0.007, -0.002, 0.001, 0.001, -0.003, 0.002, 0.002, 0.002, -0, -0.004, -0.002, 0.002, 0.002, -0.005, -
            0.001, 0.002, -0, 0
        ],
        [0.5, 0.5, 0.5, 0.251, 0.5, -0.001, 0.5, -0.5, 0.5, -0.001, 0.5, 0.5, -0.005, -0.249, 0.003, 0.25, 0.5, -
            0.5, 0.004, 0.003, 0.5, -0.5, -0, -0.001, -0.006, 0.218, 0.376, -0.006, 0, 0.002, 0.003, 0.171, 0,
            0.001, 0, -0, 0.001, 0.162, 0.002, -0.001, 0.001, -0.067, 0, 0.001, -0.001, -0.003, -0.001, 0.003,
            0.002, -0.004, 0.002, -0.004, 0.002, -0.002, -0.001, -0.004, 0.002, 0.002, 0.002, -0.003, -0.002, -
            0.004, 0.003, 0.003
        ],
        [0.5, 0.5, 0.5, 0.5, 0.248, 0.5, 0.001, 0.5, -0.5, 0.5, -0.001, 0.5, 0.5, -0.002, -0.25, -0.003, 0.246, 0.5,
            -0.5, 0.003, -0.004, 0.5, -0.5, -0.001, -0, -0.001, 0.222, 0.376, -0, -0.001, 0.003, -0.002, 0.166,
            0.004, -0.003, 0.003, -0.005, -0.002, 0.166, 0, 0.005, -0.002, -0.076, -0.001, 0.001, 0, -0.001, 0.003,
            0.006, -0.002, 0.004, -0.001, 0.003, -0.001, 0.001, -0, -0.002, 0, -0.002, 0.001, -0, -0.001, 0.003,
            0.003
        ],
        [-0.002, 0.5, 0.5, 0.5, 0.5, 0.248, 0.5, 0.002, 0.5, -0.5, 0.5, 0.005, 0.5, 0.5, -0.001, -0.25, -0.002,
            0.248, 0.5, -0.5, 0.001, 0.002, 0.5, -0.5, -0, 0.001, -0.002, 0.217, 0.373, 0.002, -0.002, -0.001,
            0.001, 0.167, 0.003, -0.001, -0.003, -0.002, 0.001, 0.164, -0, 0.003, -0.001, -0.068, 0.002, -0.005, -
            0.001, -0, 0.003, 0.007, -0.002, 0.004, 0, -0.005, 0.002, 0, 0.001, 0.002, 0.002, -0, -0.002, -0.001, -
            0.001, 0.003
        ],
        [0.5, 0.005, 0.5, 0.5, 0.5, -0.5, 0.249, 0.253, -0.002, 0.5, 0, -0.5, 0.002, 0.249, 0.5, 0.003, 0.002,
            0.002, 0.253, 0.251, 0.5, -0.001, -0.003, -0.5, -0.5, 0.003, 0, 0, -0.001, -0.378, 0.209, 0.001, -0.001,
            -0.001, 0, 0.429, 0.001, -0.004, 0, -0.003, 0.002, 0.171, -0.001, -0.001, 0, 0.006, 0.003, 0, 0.002, -0,
            0.003, 0.005, -0.003, 0.004, 0.006, -0.001, -0.001, 0.003, 0.003, 0.001, -0.002, -0.002, 0.002, 0
        ],
        [0.5, 0.5, 0.003, 0.5, 0.5, 0.5, -0.5, 0.253, 0.25, -0, 0.5, -0.005, -0.5, -0.002, 0.25, 0.5, 0, -0.007, -
            0.004, 0.251, 0.251, 0.5, 0, 0.001, -0.5, -0.5, 0.002, 0.001, 0.002, 0.001, -0.373, 0.21, -0.004, 0,
            0.001, 0.001, 0.428, -0.003, 0.001, 0, 0.002, 0.003, 0.176, 0, -0.003, 0.002, -0.003, -0.005, 0, 0.003,
            0.003, 0.003, 0.005, -0, -0, -0, -0.003, 0.004, -0.004, -0.002, -0.005, -0.001, -0.001, -0.006
        ],
        [0.5, 0.5, 0.5, 0.003, 0.5, 0.5, 0.5, -0.5, 0.25, 0.251, 0.005, 0.5, 0.005, -0.5, -0.002, 0.25, 0.5, -0.001,
            -0.003, -0.001, 0.251, 0.255, 0.5, 0.002, 0.004, -0.5, -0.5, 0.002, -0.003, -0.002, 0.004, -0.376,
            0.208, 0.001, -0, -0.004, -0.002, 0.428, 0.001, 0.002, -0.001, 0.005, -0.002, 0.169, 0.003, -0.004,
            0.003, -0.002, 0.004, 0.002, 0.002, 0.004, 0.002, -0.002, -0.003, -0.002, 0.004, -0.001, 0.003, -0.001,
            0.001, 0.002, 0.003, -0.007
        ],
        [0.5, 0.5, 0.5, 0.5, -0.002, 0.5, 0.5, 0.5, -0.5, 0.251, 0.253, 0, 0.5, 0.002, -0.5, 0.001, 0.246, 0.5,
            0.003, -0.004, -0.004, 0.255, 0.249, 0.5, 0.001, -0.003, -0.5, -0.5, 0.001, 0.003, 0.001, -0.001, -
            0.374, 0.207, -0.003, 0.006, -0.002, -0.001, 0.429, 0, -0, -0.006, -0.003, -0.006, 0.172, 0.001, 0.001,
            -0.002, 0.005, -0.002, -0, 0.003, -0.002, -0.002, -0.005, -0.003, 0.003, 0.002, -0.001, 0.003, -0.002, -
            0.001, 0.001, 0.001
        ],
        [-0, 0.5, 0.5, 0.5, 0.5, 0.002, 0.5, 0.5, 0.5, -0.5, 0.253, 0.252, -0.006, 0.5, 0.001, -0.5, -0.004, 0.248,
            0.5, -0.003, -0.003, 0.002, 0.249, 0.25, 0.5, -0.001, 0.004, -0.5, -0.5, 0.005, 0.002, -0, -0.001, -
            0.372, 0.208, -0.003, 0.002, 0.003, -0.001, 0.429, 0.003, -0.005, 0.003, -0.001, 0.002, 0.173, -0.003, -
            0.001, 0.001, 0.003, -0.002, -0.004, -0.002, -0.003, 0.001, -0.001, 0.006, -0, 0.007, 0.002, -0.006,
            0.007, 0.004, 0.004
        ],
        [0.5, 0.003, 0.5, 0.5, 0.5, -0.5, 0.003, 0.253, 0.5, 0.5, 0, -0.252, 0.249, 0.002, 0.5, -0.003, 0.002,
            0.003, 0.253, 0.251, 0.002, 0.001, -0.002, -0.25, 0.253, 0.003, 0.003, 0, 0.003, 0.5, -0.002, -0.001,
            0.001, -0.006, 0.002, 0.002, 0.003, -0.002, 0.002, -0.005, -0.002, -0.001, -0.003, -0, -0.004, 0.002,
            0.001, -0.004, -0.006, 0.002, -0.001, 0.004, 0, 0.001, -0.002, 0, 0.003, -0.004, -0.003, -0.001, 0.002,
            -0.003, -0.004, 0.003
        ],
        [0.5, 0.5, -0, 0.5, 0.5, 0.5, -0.5, -0, 0.25, 0.5, 0.5, -0.005, -0.249, 0.249, 0.003, 0.5, 0, -0.006, 0.005,
            0.251, 0.251, 0.002, 0.001, -0.002, -0.253, 0.249, 0.002, -0.001, 0.003, -0.002, 0.5, -0.002, 0, -0.006,
            0.001, 0.003, 0, -0.003, -0.001, 0, -0.001, -0.004, 0.003, -0, 0.001, 0.003, 0.003, -0.002, 0.003,
            0.002, 0.001, 0.002, 0.001, -0.001, 0.001, 0.001, -0.004, 0.002, 0.002, 0, -0.002, 0.002, -0.001, -0.002
        ],
        [0.5, 0.5, 0.5, 0.002, 0.5, 0.5, 0.5, -0.5, 0.002, 0.251, 0.5, 0.5, 0.005, -0.249, 0.25, 0.003, 0.5, 0.001,
            -0.004, 0.004, 0.251, 0.255, -0.004, -0.001, 0.002, -0.249, 0.251, -0.007, -0.003, 0.001, -0.006, 0.5,
            0.001, -0.006, -0.002, 0.002, 0.002, 0.004, 0.002, 0.002, -0.001, 0.006, 0, -0.003, 0.003, -0.001,
            0.002, -0.001, 0, -0.001, 0.007, -0.003, -0.002, 0.003, -0.001, 0.004, -0.001, 0, -0.004, 0.003, 0.003,
            0.001, -0.004, -0.005
        ],
        [0.5, 0.5, 0.5, 0.5, -0, 0.5, 0.5, 0.5, -0.5, 0.003, 0.253, 0.5, 0.5, 0.002, -0.25, 0.25, 0.003, 0.5, -
            0.003, -0.003, -0.002, 0.255, 0.249, -0.001, -0.001, 0.002, -0.251, 0.249, 0.003, -0.003, -0.005, 0.002,
            0.5, -0.003, -0.001, 0.006, 0.002, -0.002, 0.002, 0.002, -0.002, 0.001, 0.001, -0.001, -0.003, 0.001, -
            0.001, -0.001, 0.002, -0.004, -0.002, -0.001, -0, -0.003, 0.002, -0.003, -0.004, 0.003, -0.004, 0,
            0.006, -0.003, -0, -0.002
        ],
        [0.5, 0.5, 0.5, 0.5, 0.5, 0.007, 0.5, 0.5, 0.5, -0.5, -0.006, 0.252, 0.5, 0.5, 0.001, -0.25, 0.246, -0.003,
            0.5, 0.003, -0.001, 0, 0.249, 0.25, -0.004, 0.003, 0.004, -0.249, 0.244, -0.001, 0.002, 0.005, -0.001,
            0.5, 0, -0, -0.001, -0.001, 0.001, -0.005, 0.005, 0.002, 0.001, -0.001, -0.001, 0.002, 0.004, -0.003, -
            0, 0.001, 0.001, 0.002, 0.002, -0.001, -0.002, -0.007, -0.003, -0.003, -0.001, 0.006, 0, 0, -0.006,
            0.004
        ],
        [-0.001, 0.5, 0.5, 0.5, 0.5, 0.5, 0.001, 0.5, 0.5, 0.5, -0.5, 0.001, 0.249, 0.5, 0.5, -0.003, -0.246, 0.248,
            -0.003, 0.5, 0.002, 0.008, 0.001, 0.25, 0.253, 0.002, -0.003, -0.002, -0.244, 0.249, -0.002, 0.001,
            0.005, 0.001, 0.5, 0, 0.001, 0.004, -0.004, 0.001, 0.002, 0.002, 0.001, 0.003, -0.001, -0.002, -0,
            0.001, 0, 0.002, 0.001, -0.004, 0.005, 0.001, 0.001, -0.001, -0.002, -0.003, -0.002, 0.004, -0.002,
            0.001, -0.006, -0.002
        ],
        [0.5, 0.001, 0.5, 0.5, 0.5, 0.5, 0.5, -0.001, 0.5, 0.5, 0.5, -0.5, 0.004, 0.249, 0.5, 0.5, 0, -0.248, 0.253,
            0, 0.5, 0.002, 0.002, -0.001, 0.253, 0.249, -0.001, 0.001, -0.003, -0.249, 0.247, 0.003, -0, -0, 0, 0.5,
            0.004, -0.001, 0.001, -0.004, -0.003, 0.001, 0, 0.001, 0.006, -0.001, -0.006, 0.001, 0, 0, -0.003,
            0.002, -0.006, -0.002, 0.001, 0.002, 0.003, 0.001, -0.004, -0.001, 0.001, 0.007, 0.005, 0.003
        ],
        [0.5, 0.5, 0.002, 0.5, 0.5, 0.5, 0.5, 0.5, -0.004, 0.5, 0.5, 0.5, -0.5, -0.001, 0.25, 0.5, 0.5, 0.001, -
            0.253, 0.251, 0.003, 0.5, -0.004, -0.002, 0.004, 0.249, 0.251, -0.003, 0.003, -0.003, -0.247, 0.252,
            0.003, -0.005, 0, -0.001, 0.5, -0.002, -0.002, -0.003, 0.001, 0.001, 0.002, -0, 0.001, -0.002, 0.002,
            0.003, 0.002, -0.003, -0.002, 0.001, -0.003, 0, 0.001, -0.002, -0.009, -0.001, -0, -0.003, -0.001,
            0.001, 0.001, 0
        ],
        [0.5, 0.5, 0.5, -0.002, 0.5, 0.5, 0.5, 0.5, 0.5, 0, 0.5, 0.5, 0.5, -0.5, -0.001, 0.25, 0.5, 0.5, -0.003, -
            0.251, 0.251, 0.002, 0.5, -0.001, 0.004, 0, 0.251, 0.249, -0.001, 0.003, 0.001, -0.252, 0.25, 0.001, -0,
            -0.002, 0.001, 0.5, -0.002, -0.004, 0.001, 0.006, -0.002, 0, 0.001, -0.002, -0.009, 0.005, 0.002, -
            0.005, -0.005, 0.003, -0.004, 0.003, 0, -0, -0.002, -0.003, 0.003, 0.001, -0.005, -0.001, 0.001, -0.003
        ],
        [0.5, 0.25, 0.5, 0.5, -0, -0.5, 0.5, 0.253, 0.5, 0.5, -0.001, -0.5, 0.5, 0.249, -0.5, 0.008, -0.002, -0.5,
            0.5, 0.001, 0.251, 0.005, -0.002, -0.5, -0.004, -0, 0.007, 0.001, -0.002, 0, -0.003, 0.002, -0.002,
            0.001, 0.004, 0.002, 0, 0, 0.002, 0, -0.001, 0.001, 0.001, 0.004, -0.006, -0.001, 0.001, 0.001, 0.001,
            0.002, 0.003, -0.008, 0, 0, 0.005, 0.001, 0, -0, 0.002, -0.001, 0.001, -0.002, 0.002, 0.001
        ],
        [-0.5, 0.5, 0.253, 0.5, 0.5, 0.005, -0.5, 0.5, 0.25, 0.5, 0.5, -0.005, -0.5, 0.5, 0.25, -0.5, -0.006, 0.007,
            -0.5, 0.5, 0.003, 0.255, -0.005, 0.003, -0.5, 0.002, -0.006, 0.003, 0.004, 0.003, 0, 0.002, -0, 0.004,
            0.004, -0.004, -0, 0.004, 0.003, -0.006, 0, -0.005, 0.007, 0, 0.001, -0.004, -0.002, -0.003, 0, 0.004,
            0.004, 0.002, -0.003, -0.002, -0.002, 0.003, 0.003, 0.001, -0.002, -0.004, -0.002, -0.001, 0.001, 0.003
        ],
        [0.5, -0.5, 0.5, 0.251, 0.5, 0.5, 0, -0.5, 0.5, 0.251, 0.5, 0.5, -0, -0.5, 0.5, 0.25, -0.5, -0.003, 0.003, -
            0.5, 0.5, 0.003, 0.249, -0.002, -0.001, -0.5, -0.001, -0.002, 0.003, -0.001, 0.006, 0, 0.004, 0.002,
            0.002, -0.002, 0.002, -0.002, 0.004, 0.001, -0.002, 0, -0.001, -0.001, 0.002, 0.002, 0.003, 0.002,
            0.001, 0.001, 0.004, -0.002, 0.001, -0.007, -0.004, -0.004, 0.005, -0.001, 0.004, 0.003, -0.002, -0.004,
            0.002, -0.001
        ],
        [0.5, 0.5, -0.5, 0.5, 0.248, 0.5, 0.5, -0.006, -0.5, 0.5, 0.253, 0.5, 0.5, -0.003, -0.5, 0.5, 0.246, -0.5,
            0.003, 0.004, -0.5, 0.5, 0.001, 0.25, -0.001, 0.003, -0.5, -0.003, -0, 0.001, -0, -0.001, -0.002, 0.006,
            0.001, -0.003, 0.001, -0.003, 0.001, 0.001, 0.003, 0.002, -0.004, 0.003, 0.003, -0.005, -0.001, 0.005, -
            0.003, 0.001, -0.002, -0.001, 0.001, -0, -0.002, -0.003, 0.001, 0.002, -0.001, 0.001, 0.001, 0.001,
            0.001, -0.002
        ],
        [0.5, 0.5, 0.5, -0.5, 0.5, 0.248, 0.5, 0.5, 0.002, -0.5, 0.5, 0.252, 0.5, 0.5, 0.001, -0.5, 0.5, 0.248, -
            0.5, 0.003, 0.003, -0.5, 0.5, 0.001, 0.253, 0.003, -0, -0.5, -0.001, -0.001, 0, 0.004, 0.001, 0.004, 0,
            -0.003, 0.004, 0.003, 0.004, -0.001, -0.008, 0.001, 0.001, 0.003, -0.001, 0.003, 0.001, -0.004, 0.001, -
            0.005, 0.001, -0.004, -0.001, 0.001, -0.001, -0, 0, 0.001, -0.005, 0.003, -0.003, 0.005, -0.003, 0.003
        ],
        [0.251, 0.5, 0.5, 0.5, -0.5, 0.5, 0.249, 0.5, 0.5, 0.004, -0.5, 0.5, 0.249, 0.5, 0.5, -0.001, -0.5, 0.5,
            0.253, -0.5, 0.007, -0.005, -0.5, 0.5, 0, 0.249, 0, -0.001, -0.5, -0, -0.004, 0, 0.006, -0.006, 0.004,
            0.002, -0.001, 0.006, 0.001, -0.001, -0.001, -0.004, 0.001, 0.002, -0, -0.004, -0, -0.002, -0.003, -
            0.001, -0.003, 0.003, 0.003, -0.001, -0.001, -0.002, -0, 0, 0.002, -0.006, 0.002, -0.001, 0.001, 0.001
        ]
    ];

    function currentKey() {
        let allP = 0;
        for (let i = 0; i < Math.pow(2, 10); i++) {
            key = "0000000100" +
                "1000110100" +
                "0101011001" +
                "1110001100" +
                "0011010101" +
                "1111011011" +
                "1101111000";
            let temp = i.toString(2);
            let res = temp;
            if (temp.length < 10) {
                for (let i = 0; i < 10 - temp.length; i++) {
                    res = '0' + res
                }
            }
            key = key + res;
            let f1 = f();
            let count = 0;
            for (let i = 0; i < f1.length; i++) {
                const element = f1[i];
                if (f1[i] && f1[i].indexOf(i) !== -1) {
                    count++;
                }
            }
            if (parseFloat(count / f1.length) === 1) {
                console.log(key);
                return;
            }
            allP = allP + parseFloat(count / f1.length);
            console.log("单个准确率", parseFloat(count / f1.length));
        }
        console.log("整体准确率", parseFloat(allP / Math.pow(2, 10)));
    }
    // currentKey();
    // 密钥装载阶段
    function frvitV2() {
        if (key.length !== 80) {
            console.log("error");
        }
        for (let i = 0; i < NFSR.length; i++) {
            NFSR[i] = key.charAt(i) === '1' ? 1 : 0;
        }
        let j = 0;
        for (let i = NFSR.length; i < NFSR.length + LFSR.length; i++) {
            LFSR[j] = key.charAt(i) === '1' ? 1 : 0;
            j++;
        }
        for (let i = 0; i < Cr.length; i++) {
            Cr[i] = 0;
        }
        for (let i = 0; i < Cc.length; i++) {
            Cc[i] = 0;
        }
    }
    // 初始化阶段
    function init() {
        frvitV2();
        // 第一轮初始化
        let fb = 0;
        for (let i = 0; i < 130; i++) {
            clockOneTime(fb, LFSR, NFSR);
            let z = output(LFSR, NFSR);
            let iv = IV.charAt(i) === '1' ? 1 : 0;
            fb = z ^ iv
        }
        // 第二轮初始化
        LFSR[0] = 1;
        Cr[6] = LFSR[0];
        for (let i = 0; i < 6; i++) {
            Cr[i] = NFSR[i];
        }
        // console.log('第二轮————————————————————————————',Cr);
        for (let i = 0; i < 80; i++) {
            clockOneTime(0, LFSR, NFSR);
        }

    }
    // 轮密钥函数
    function keyRound() {
        let s = parseInt((Cr[4]) * Math.pow(2, 0)) +
            parseInt((Cr[3]) * Math.pow(2, 1)) +
            parseInt((Cr[2]) * Math.pow(2, 2)) +
            parseInt((Cr[1]) * Math.pow(2, 3)) +
            parseInt((Cr[0]) * Math.pow(2, 4));
        let y = parseInt((Cr[2]) * Math.pow(2, 0)) +
            parseInt((Cr[1]) * Math.pow(2, 1)) +
            parseInt((Cr[0]) * Math.pow(2, 2)) +
            parseInt((Cr[6]) * Math.pow(2, 3)) +
            parseInt((Cr[5]) * Math.pow(2, 4)) + 32;
        let u = parseInt((Cr[6]) * Math.pow(2, 0)) +
            parseInt((Cr[5]) * Math.pow(2, 1)) +
            parseInt((Cr[4]) * Math.pow(2, 2)) +
            parseInt((Cr[3]) * Math.pow(2, 3)) + 64;
        let p = parseInt((Cr[3]) * Math.pow(2, 0)) +
            parseInt((Cr[2]) * Math.pow(2, 1)) +
            parseInt((Cr[1]) * Math.pow(2, 2)) +
            parseInt((Cr[0]) * Math.pow(2, 3));
        let q = parseInt((Cr[1]) * Math.pow(2, 0)) +
            parseInt((Cr[0]) * Math.pow(2, 1)) +
            parseInt((Cr[6]) * Math.pow(2, 2)) +
            parseInt((Cr[5]) * Math.pow(2, 3)) +
            parseInt((Cr[4]) * Math.pow(2, 4)) + 16;
        let r = parseInt((Cr[6]) * Math.pow(2, 0)) +
            parseInt((Cr[5]) * Math.pow(2, 1)) +
            parseInt((Cr[4]) * Math.pow(2, 2)) +
            parseInt((Cr[3]) * Math.pow(2, 3)) +
            parseInt((Cr[2]) * Math.pow(2, 4)) + 48;
        let k = (parseInt(key.charAt(s)) & parseInt(key.charAt(y))) ^
            (parseInt(key.charAt(u)) & parseInt(key.charAt(p))) ^
            parseInt(key.charAt(q)) ^ parseInt(key.charAt(r));
        return k;
    }
    // NFSR反馈函数
    function feedbackNFSR(lfsr, nfsr) {
        let g;
        g = keyRound() ^ lfsr[0] ^ Cr[3] ^ nfsr[0] ^ nfsr[10] ^ nfsr[20] ^ (nfsr[12] & nfsr[3]) ^
            (nfsr[14] & nfsr[25]) ^ (nfsr[5] & nfsr[23] & nfsr[31]) ^ (nfsr[8] & nfsr[18]) ^
            (nfsr[28] & nfsr[30] & nfsr[32] & nfsr[34]);
        return g;
    }

    // LFSR反馈函数
    function feedbackReverseLFSR(lfsr) {
        return lfsr[36] ^ lfsr[27] ^ lfsr[22] ^ lfsr[17] ^ lfsr[7];
    }

    // NFSR反馈函数
    function feedbackReverseNFSR(lfsr, nfsr) {
        let g;
        g = keyRound() ^ lfsr[0] ^ Cr[3] ^ nfsr[9] ^ nfsr[19] ^ (nfsr[11] & nfsr[2]) ^
            (nfsr[13] & nfsr[24]) ^ (nfsr[4] & nfsr[22] & nfsr[30]) ^ (nfsr[7] & nfsr[17]) ^
            (nfsr[27] & nfsr[29] & nfsr[31] & nfsr[33]);
        return g;
    }

    // LFSR反馈函数
    function feedbackLFSR(lfsr) {
        return lfsr[37] ^ lfsr[28] ^ lfsr[23] ^ lfsr[18] ^ lfsr[8] ^ lfsr[0];
    }

    function output(lfsr, nfsr) {
        let z;
        let h;
        h = (lfsr[6] & lfsr[15]) ^ (lfsr[1] & lfsr[22]) ^ (nfsr[35] & lfsr[27]) ^ (lfsr[11] & lfsr[33]) ^
            (nfsr[1] & nfsr[33] & lfsr[42]);

        z = h ^ nfsr[0] ^ nfsr[7] ^ nfsr[13] ^ nfsr[19] ^ nfsr[24] ^ nfsr[29] ^ nfsr[36] ^ lfsr[38];
        return z;
    }

    function clockOneTime(fb) {
        let fbLFSR = feedbackLFSR(LFSR);
        let fbNFSR = feedbackNFSR(LFSR, NFSR);

        for (let i = 0; i < LFSR.length - 1; i++) {
            LFSR[i] = LFSR[i + 1];
        }
        for (let i = 0; i < NFSR.length - 1; i++) {
            NFSR[i] = NFSR[i + 1];
        }

        NFSR[36] = fbNFSR ^ fb;
        LFSR[42] = fbLFSR ^ fb;

        let temp = 0,
            j = 0;
        for (let i = Cr.length - 1; i >= 0; i--) {
            temp += Cr[i] * Math.pow(2, j);
            j++;
        }
        temp = temp + 1;
        count(temp);
    }


    function clockReverseOneTime() {
        let fbLFSR = feedbackReverseLFSR(LFSR);
        let fbNFSR = feedbackReverseNFSR(LFSR, NFSR);
        LFSR[0] = LFSR[42] ^ fbLFSR;
        NFSR[0] = NFSR[36] ^ fbNFSR;

        for (let i = LFSR.length - 1; i > 0; i--) {
            LFSR[i] = LFSR[i - 1];
        }
        for (let i = NFSR.length - 1; i > 0; i--) {
            NFSR[i] = NFSR[i - 1];
        }



        let temp = 0,
            j = 0;
        for (let i = Cr.length - 1; i >= 0; i--) {
            temp += Cr[i] * Math.pow(2, j);
            j++;
        }
        temp = temp - 1;
        count(temp);
    }

    function count(temp) {
        for (let i = Cr.length - 1; i >= 0; i--) {
            Cr[i] = (temp % 2 == 1) ? 1 : 0;
            temp = parseInt(temp / 2);
        }
    }

    function reverseStream() {
        init();
        let Stream = [];
        for (let i = -1; i > -33; i--) {
            clockReverseOneTime(LFSR, NFSR);
            Stream.unshift(output(LFSR, NFSR));
        }
        console.log('无错误反向密钥流', Stream.join(""));
        return Stream;
    }

    function stream() {
        init();
        let Stream = [];
        for (let i = 0; i < 64; i++) {
            Stream.push(output(LFSR, NFSR));
            clockOneTime(0, LFSR, NFSR);
        }
        // console.log('无错误密钥流', Stream.join(""));
        return Stream;
    }

    function reverseFaultStream() {
        init();
        if (LFSR[36] === 1) {
            LFSR[36] = 0;
        } else {
            LFSR[36] = 1;
        }
        let Stream = [];
        for (let i = -1; i > -33; i--) {

            clockReverseOneTime(LFSR, NFSR);
            Stream.unshift(output(LFSR, NFSR));

        }
        console.log('有错误反向密钥流', Stream.join(""));
        return Stream;
    }

    function faultStream(n) {
        init();
        if (LFSR[n] === 1) {
            LFSR[n] = 0;
        } else {
            LFSR[n] = 1;
        }
        let Stream = [];
        for (let i = 0; i < 64; i++) {
            Stream.push(output(LFSR, NFSR));
            clockOneTime(0, LFSR, NFSR);
        }
        // console.log('有错误密钥流', Stream.join(""));
        return Stream;
    }

    //需要数据：1.签名向量Qf；2.错误路径Lg；3.相关系数u(Q,L)
    function QFData(x) {

        for (let k = 0; k < 50; k++) {
            let result = [];
            for (let index = 0; index < x; index++) {
                result[index] = 0;
            }
            for (let i = 0; i < Math.pow(2, 15); i++) {
                key = "0000000100" +
                    "1000110100" +
                    "0101011001" +
                    "1110001100" +
                    "0011010101" +
                    "1111011011" +
                    "11011";
                let temp = i.toString(2);
                let res = temp;
                if (temp.length < 15) {
                    for (let i = 0; i < 15 - temp.length; i++) {
                        res = '0' + res
                    }
                }
                key = key + res;
                let output = stream().splice('');
                let faultOutput = faultStream(k).splice('');
                for (let j = 0; j < output.length; j++) {
                    if (output[j] !== faultOutput[j]) {
                        result[j] += 1;
                    }
                }

            }
            for (let i = 0; i < result.length; i++) {
                result[i] = parseFloat((0.5 - result[i] / Math.pow(2, 15)).toFixed(3));
            }
            console.log(k, result);

        }

    }

    function LGData(f) {
        let res = [];
        let output = stream().splice('');
        let faultOutput = faultStream(f).splice('');
        for (let j = 0; j < output.length; j++) {
            if (output[j] !== faultOutput[j]) {
                res[j] = 1;
            } else {
                res[j] = 0;
            }
        }
        for (let i = 0; i < res.length; i++) {
            res[i] = (0.5 - res[i]);
        }
        return res;
    }
    console.log('Fruit v2 111');

    // QFData(64);

    // console.log(uData(a, b));
    // 计算两个向量的相关系数
    function uData(a, b) {
        let avgQf = avg(a);
        let avgLg = avg(b);
        let top = 0;
        let left = 0;
        let right = 0;
        for (let i = 0; i < a.length; i++) {
            top += (a[i] - avgQf) * (b[i] - avgLg);
            left += Math.pow((a[i] - avgQf), 2);
            right += Math.pow((b[i] - avgLg), 2);
        }
        left = Math.sqrt(left);
        right = Math.sqrt(right);
        return (top / (left * right));
    }

    function avg(arr) {
        let sum = 0;
        for (let i = 0; i < arr.length; i++) {
            sum += arr[i];
        }
        return (sum / arr.length);
    }

    function maxUData() {
        for (let f = 0; f < 43; f++) {
            let uRes = [];
            for (let i = 0; i < Qf.length; i++) {
                uRes[i] = uData(Qf[i], LGData(f));
            }
            console.log(uRes);
            console.log(f);
            console.log(uRes.max()[0].toFixed(3));
            console.log(uData(Qf[f], LGData(f)).toFixed(3));
            let r = uData(Qf[f], LGData(f)).toFixed(3);
            let Tg = [];
            while (uRes.max()[0] !== uData(Qf[f], LGData(f))) {
                Tg.push(uRes.max()[1]);
                uRes[uRes.max()[1]] = Number.MIN_VALUE;
            }
            if (uRes.max()[0] === uData(Qf[f], LGData(f))) {
                Tg.push(uRes.max()[1]);
            }
            console.log(Tg);


        }


    }
    Array.prototype.max = function () {
        var max = this[0];
        let index = 0;
        var len = this.length;
        for (var i = 1; i < len; i++) {
            if (this[i] > max) {
                max = this[i];
                index = i;
            }
        }
        return [max, index];
    }
    maxUData();

    function bin_to_hex(str) {
        let hex_array = [{
                key: 0,
                val: "0000"
            }, {
                key: 1,
                val: "0001"
            }, {
                key: 2,
                val: "0010"
            }, {
                key: 3,
                val: "0011"
            }, {
                key: 4,
                val: "0100"
            }, {
                key: 5,
                val: "0101"
            }, {
                key: 6,
                val: "0110"
            }, {
                key: 7,
                val: "0111"
            },
            {
                key: 8,
                val: "1000"
            }, {
                key: 9,
                val: "1001"
            }, {
                key: 'a',
                val: "1010"
            }, {
                key: 'b',
                val: "1011"
            }, {
                key: 'c',
                val: "1100"
            }, {
                key: 'd',
                val: "1101"
            }, {
                key: 'e',
                val: "1110"
            }, {
                key: 'f',
                val: "1111"
            }
        ]
        let value = ''
        let list = []
        if (str.length % 4 !== 0) {
            let a = "0000"
            let b = a.substring(0, 4 - str.length % 4)
            str = b.concat(str)
        }
        while (str.length > 4) {
            list.push(str.substring(0, 4))
            str = str.substring(4);
        }
        list.push(str)
        for (let i = 0; i < list.length; i++) {
            for (let j = 0; j < hex_array.length; j++) {
                if (list[i] == hex_array[j].val) {
                    value = value.concat(hex_array[j].key)
                    break
                }
            }
        }
        return value
    }

    function f() {
        // console.log(reverseStream());
        // console.log(reverseFaultStream());
        // let s = reverseStream().concat(stream());
        // let sf = reverseFaultStream().concat(faultStream());
        let f1All = [];
        for (let i = 0; i < 43; i++) {
            let s = stream(),
                sf = faultStream(i);
            let res = [];
            for (let i = 0; i < s.length; i++) {
                if (s[i] === sf[i]) {
                    res.push(1);
                } else {
                    res.push(0);
                }
            }

            let sgn = PRGA();
            let f1 = [];
            // console.log(res);
            // console.log(sgn[0]);
            for (let i = 0; i < sgn.length; i++) {
                if (isSubset(res, sgn[i])) {
                    f1.push(i);
                }
            }
            f1All.push(f1)
        }

        return f1All;
    }

    function isSubset(res, sgn) {
        for (let i = 0; i < sgn.length; i++) {
            if (sgn[i] === 1 && res[i] !== 1) {
                return false;
            }
        }
        return true;
    }

    function round(r) {
        let h = [
            ['l6', 'l15'],
            ['l1', 'l22'],
            ['n35', 'l27'],
            ['l11', 'l33'],
            ['n1', 'n33', 'l42']
        ];
        let b = ['n0', 'n7', 'n13', 'n19', 'n24', 'n29', 'n36', 'l38'];
        for (let l = 0; l < r; l++) {
            for (let i = 0; i < b.length; i++) {
                let x = b[i].slice(0, 1);
                let n = parseInt(b[i].slice(1));
                if (x === 'l' && n === 42) {
                    b[i] = 'l0';
                    b.push(...['l7', 'l17', 'l22', 'l27', 'l36'])
                } else if (x === 'n' && n === 36) {
                    b[i] = 'l0';
                } else {
                    n = n + 1;
                    b[i] = x + n;
                }
            }
            let clockH = h;
            for (let i = 0; i < h.length; i++) {
                for (let j = 0; j < h[i].length; j++) {
                    let x = h[i][j].slice(0, 1);
                    let n = parseInt(h[i][j].slice(1));
                    if (x === 'l' && n === 42) {
                        h[i][j] = 'l0';
                        h[i].push(...['l7', 'l17', 'l22', 'l27', 'l36'])
                    } else if (x === 'n' && n === 36) {
                        h[i][j] = 'l0';
                    } else {
                        n = n + 1;
                        h[i][j] = x + n;
                    }
                }
            }
        }
        return [h, b];
    }

    function reverseRound(r) {
        let h = [
            ['l6', 'l15'],
            ['l1', 'l22'],
            ['n35', 'l27'],
            ['l11', 'l33'],
            ['n1', 'n33', 'l42']
        ];
        let b = ['n0', 'n7', 'n13', 'n19', 'n24', 'n29', 'n36', 'l38'];
        for (let l = 0; l < r; l++) {
            for (let i = 0; i < b.length; i++) {
                let x = b[i].slice(0, 1);
                let n = parseInt(b[i].slice(1));
                if (x === 'l' && n === 0 || x === 'n' && n === 0) {
                    b[i] = 'l42';
                    b.push(...['l9', 'l19', 'l24', 'l29', 'l38'])
                } else {
                    n = n - 1;
                    b[i] = x + n;
                }
            }
            for (let i = 0; i < h.length; i++) {
                for (let j = 0; j < h[i].length; j++) {
                    let x = h[i][j].slice(0, 1);
                    let n = parseInt(h[i][j].slice(1));
                    if (x === 'l' && n === 0) {
                        h[i][j] = 'l42';
                        h[i].push(...['l9', 'l19', 'l24', 'l29', 'l38'])
                    } else if (x === 'n' && n === 0) {
                        h[i][j] = 'l42';
                        h[i].push(...['l9', 'l19', 'l24', 'l29', 'l38'])
                    } else {
                        n = n - 1;
                        h[i][j] = x + n;
                    }
                }
            }
        }
        return [h, b];
    }

    function PRGA() {
        let resAll = [];
        let resAllCount = [];
        for (let l = 0; l < 43; l++) {
            let res = [];
            let resCount = 0;
            // for (let i = 1; i < 32; i++) {
            //     let temp = reverseRound(i);
            //     let count = 0;
            //     for (let bi = 0; bi < temp[1].length; bi++) {
            //         const element = temp[1][bi];
            //         if (element === 'l' + l) {
            //             count++;
            //         }
            //     }
            //     for (let hi = 0; hi < temp[0].length; hi++) {
            //         for (let hj = 0; hj < temp[0][hi].length; hj++) {
            //             const element = temp[0][hi][hj];
            //             if (element === 'l' + l) {
            //                 count++;
            //             }
            //         }
            //     }
            //     if (count !== 0) {
            //         res.unshift(0);
            //     } else {
            //         res.unshift(1);
            //         resCount++;
            //     }
            // }
            for (let i = 0; i < 32; i++) {
                let temp = round(i);
                let count = 0;
                for (let bi = 0; bi < temp[1].length; bi++) {
                    const element = temp[1][bi];
                    if (element === 'l' + l) {
                        count++;
                    }
                }
                for (let hi = 0; hi < temp[0].length; hi++) {
                    for (let hj = 0; hj < temp[0][hi].length; hj++) {
                        const element = temp[0][hi][hj];
                        if (element === 'l' + l) {
                            count++;
                        }
                    }
                }
                if (count !== 0) {
                    res.push(0);
                } else {
                    res.push(1);
                    resCount++
                }
            }
            resAll.push(res);
            resAllCount.push(resCount);
        }
        return resAll;
    }

    // console.log(PRGA());

    // console.log(f());


    function LFSRState() {
        init();
        console.log('初始化结束后的 内部状态：', LFSR.reduce((a, b) => a + b, ''), NFSR.reduce((a, b) => a + b, ''));
        let noFaultStream = '';
        let faultStream = '';
        let LFSR22 = '';
        for (let i = 0; i < 43; i++) {
            let faultLFSR = new Array(),
                faultNFSR = new Array();
            for (let i = 0; i < LFSR.length; i++) {
                faultLFSR[i] = LFSR[i];
            }
            for (let i = 0; i < NFSR.length; i++) {
                faultNFSR[i] = NFSR[i];
            }
            if (faultLFSR[1] === 1) {
                faultLFSR[1] = 0;
            } else {
                faultLFSR[1] = 1;
            }
            console.log(`第${i}轮` + '错误注入后内部状态：', faultLFSR.reduce((a, b) => a + b, ''), faultNFSR.reduce((a, b) => a +
                b, ''));
            console.log(`第${i}轮` + '无错误注入内部状态：', LFSR.reduce((a, b) => a + b, ''), NFSR.reduce((a, b) => a + b, ''));
            noFaultStream += output(LFSR, NFSR);
            faultStream += output(faultLFSR, faultNFSR);
            LFSR22 += LFSR[22];
            clockOneTime(0, LFSR, NFSR);
        }
        console.log("输出密钥流产生阶段前43轮的无错误密钥：", noFaultStream);
        console.log("输出密钥流产生阶段前43轮的  错误密钥：", faultStream);
        console.log('LFSR的第22位置在这43轮中的     状态：', LFSR22);
    }
    // LFSRState();

    function NFSRState() {
        init();
        console.log('初始化结束后的 内部状态：', LFSR.reduce((a, b) => a + b, ''), NFSR.reduce((a, b) => a + b, ''));
        let noFaultStream = '';
        let faultStream = '';
        let NFSR1 = '';
        for (let i = 0; i < 37; i++) {
            let faultLFSR = new Array(),
                faultNFSR = new Array();
            for (let i = 0; i < LFSR.length; i++) {
                faultLFSR[i] = LFSR[i];
            }
            for (let i = 0; i < NFSR.length; i++) {
                faultNFSR[i] = NFSR[i];
            }
            if (faultNFSR[33] === 1) {
                faultNFSR[33] = 0;
            } else {
                faultNFSR[33] = 1;
            }
            console.log(`第${i}轮` + '错误注入后内部状态：', faultLFSR.reduce((a, b) => a + b, ''), faultNFSR.reduce((a, b) => a +
                b, ''));
            console.log(`第${i}轮` + '无错误注入内部状态：', LFSR.reduce((a, b) => a + b, ''), NFSR.reduce((a, b) => a + b, ''));
            noFaultStream += output(LFSR, NFSR);
            faultStream += output(faultLFSR, faultNFSR);
            NFSR1 += NFSR[1];
            clockOneTime(0, LFSR, NFSR);
        }
        console.log("输出密钥流产生阶段前37轮的无错误密钥：", noFaultStream);
        console.log("输出密钥流产生阶段前37轮的  错误密钥：", faultStream);
        console.log('NFSR的第1位置在这37轮中的      状态：', NFSR1);
        console.log('NFSR的第1位置在这37轮中的      状态：', NFSR.reduce((a, b) => a + b, ''));
    }
    // NFSRState();
</script>

</html>